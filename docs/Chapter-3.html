<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Logit-modell | COVID</title>
  <meta name="description" content="Logit-modell | COVID" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="Logit-modell | COVID" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Logit-modell | COVID" />
  
  
  

<meta name="author" content="Granát Marcell &amp; Mazzag Bálint" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="logo.ico" type="image/x-icon" />
<link rel="prev" href="Chapter-2.html"/>
<link rel="next" href="Chapter-4.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.13/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<img src="logo.png" width="300" height="300">

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Mi ez a projekt?</a></li>
<li class="chapter" data-level="" data-path="Chapter-1.html"><a href="Chapter-1.html"><i class="fa fa-check"></i>Bevezetés</a></li>
<li class="chapter" data-level="" data-path="Chapter-2.html"><a href="Chapter-2.html"><i class="fa fa-check"></i>Döntési fa</a><ul>
<li class="chapter" data-level="" data-path="Chapter-2.html"><a href="Chapter-2.html#adatok-bemutatása"><i class="fa fa-check"></i>Adatok bemutatása</a><ul>
<li class="chapter" data-level="" data-path="Chapter-2.html"><a href="Chapter-2.html#forrás"><i class="fa fa-check"></i>Forrás</a></li>
<li class="chapter" data-level="" data-path="Chapter-2.html"><a href="Chapter-2.html#adatok-elemzéshez-való-előkészítése"><i class="fa fa-check"></i>Adatok elemzéshez való előkészítése</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Chapter-2.html"><a href="Chapter-2.html#modellbecslés"><i class="fa fa-check"></i>Modellbecslés</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Chapter-3.html"><a href="Chapter-3.html"><i class="fa fa-check"></i>Logit-modell</a><ul>
<li class="chapter" data-level="" data-path="Chapter-3.html"><a href="Chapter-3.html#logit-modell-kalibrálása"><i class="fa fa-check"></i>Logit modell kalibrálása</a><ul>
<li class="chapter" data-level="" data-path="Chapter-3.html"><a href="Chapter-3.html#outlierek-és-vif-mutató-szerinti-elemzés"><i class="fa fa-check"></i>Outlierek és VIF mutató szerinti elemzés</a></li>
<li class="chapter" data-level="" data-path="Chapter-3.html"><a href="Chapter-3.html#nemlinearitás-vizsgálata-a-reset-teszttel"><i class="fa fa-check"></i>Nemlinearitás vizsgálata a RESET-teszttel</a></li>
<li class="chapter" data-level="" data-path="Chapter-3.html"><a href="Chapter-3.html#előrejelzés-a-kiválasztott-modellel"><i class="fa fa-check"></i>Előrejelzés a kiválasztott modellel</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="Chapter-4.html"><a href="Chapter-4.html"><i class="fa fa-check"></i>Szövegelemzés</a><ul>
<li class="chapter" data-level="" data-path="Chapter-4.html"><a href="Chapter-4.html#elemzés"><i class="fa fa-check"></i>Elemzés</a><ul>
<li class="chapter" data-level="" data-path="Chapter-4.html"><a href="Chapter-4.html#bag-of-words"><i class="fa fa-check"></i>Bag of Words</a></li>
<li class="chapter" data-level="" data-path="Chapter-4.html"><a href="Chapter-4.html#sentiment-elemzés"><i class="fa fa-check"></i>Sentiment elemzés</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="Chapter-5.html"><a href="Chapter-5.html"><i class="fa fa-check"></i>Idősor elemzés</a><ul>
<li class="chapter" data-level="" data-path="Chapter-5.html"><a href="Chapter-5.html#sarima"><i class="fa fa-check"></i>SARIMA</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">COVID</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="Chapter-3" class="section level1">
<h1>Logit-modell</h1>
<style type="text/css">
p {
  text-align: justify;
}
</style>
<p>A logit-modell építése során az a legfontosabb feladatunk, hogy a <strong>megfertőződött</strong>
<strong>egyének paraméterei alapján megbecsüljük a halálozásuk valószínűségét</strong>. Mint tapasztalhattuk,
leginkább az idősebb korosztályt érintette súlyosabban a vírus, de az életkoron kívül
felhasználjuk még az országokat, és a nemet is.</p>
<p>A bemutatott adattábla torzítottsága miatt a modellünkben csak ázsiai országok adatait
használjuk, így a kontinens változóját nem, csak az országokét használtuk.</p>
<div id="logit-modell-kalibrálása" class="section level2">
<h2>Logit modell kalibrálása</h2>
<div id="outlierek-és-vif-mutató-szerinti-elemzés" class="section level3">
<h3>Outlierek és VIF mutató szerinti elemzés</h3>
<pre><code>
Philippines       India   Singapore       China     Vietnam South Korea 
       4503         521         118          76          32          20 
   Malaysia       Japan       Nepal 
          6           4           2 </code></pre>
<p>Láthatjuk, hogy a legtöbb megfigyelést Fülöp-szigetek és India adja</p>
<p>A változók tisztításának lépései:<br />
-<strong>először az alapmodellünk során kirajzolódott outliereket szűrjük ki </strong><br />
-<strong>az országok közül India és a Fülöp-szigetek rendelkezik nagy VIF-mutatóval,</strong>
<strong>így ezeket összevonjuk</strong>, ezzel eltüntetve a magas VIF-értékeket<br />
</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="Chapter-3.html#cb15-1"></a><span class="co">#Országok közül India és Fülöp-szigetek rendelkezik magas VIF-el</span></span>
<span id="cb15-2"><a href="Chapter-3.html#cb15-2"></a>logit &lt;-<span class="st"> </span><span class="kw">glm</span>(died<span class="op">~</span>age<span class="op">+</span>sex<span class="op">+</span>country<span class="op">+</span>chronic_disease_binary, <span class="dt">data=</span>data_Asia, <span class="dt">family=</span><span class="kw">binomial</span>(logit))</span>
<span id="cb15-3"><a href="Chapter-3.html#cb15-3"></a><span class="kw">summary</span>(logit)</span></code></pre></div>
<pre><code>
Call:
glm(formula = died ~ age + sex + country + chronic_disease_binary, 
    family = binomial(logit), data = data_Asia)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-3.1615  -0.5805  -0.3187  -0.0001   3.2810  

Coefficients:
                             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                -3.849e+00  3.614e-01 -10.652  &lt; 2e-16 ***
age                         6.925e-02  2.634e-03  26.291  &lt; 2e-16 ***
sexTRUE                     3.587e-01  8.271e-02   4.337 1.44e-05 ***
countryIndia                1.312e+00  3.504e-01   3.745  0.00018 ***
countryJapan               -1.654e+01  1.958e+03  -0.008  0.99326    
countryMalaysia            -1.717e+01  1.347e+03  -0.013  0.98983    
countryNepal               -1.629e+01  2.797e+03  -0.006  0.99535    
countryPhilippines         -1.529e+00  3.325e-01  -4.597 4.29e-06 ***
countrySingapore           -1.715e+01  3.343e+02  -0.051  0.95910    
countrySouth Korea         -1.643e+01  8.259e+02  -0.020  0.98413    
countryThailand            -1.761e+01  2.797e+03  -0.006  0.99498    
countryVietnam             -1.880e+01  5.651e+02  -0.033  0.97347    
chronic_disease_binaryTRUE  2.331e+00  3.038e-01   7.674 1.67e-14 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 5875.9  on 5283  degrees of freedom
Residual deviance: 3889.3  on 5271  degrees of freedom
AIC: 3915.3

Number of Fisher Scoring iterations: 16</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="Chapter-3.html#cb17-1"></a><span class="kw">vif</span>(logit)</span></code></pre></div>
<pre><code>                       age                    sexTRUE 
                  1.064698                   1.017816 
              countryIndia               countryJapan 
                  7.529853                   1.056988 
           countryMalaysia               countryNepal 
                  1.084271                   1.028635 
        countryPhilippines           countrySingapore 
                  9.458835                   2.610870 
        countrySouth Korea            countryThailand 
                  1.280892                   1.028172 
            countryVietnam chronic_disease_binaryTRUE 
                  1.429719                   1.104861 </code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="Chapter-3.html#cb19-1"></a><span class="co">#Outlierek leszűrése</span></span>
<span id="cb19-2"><a href="Chapter-3.html#cb19-2"></a>data_Asia &lt;-<span class="st"> </span>data_Asia[<span class="kw">abs</span>(<span class="kw">rstudent</span>(logit))<span class="op">&lt;</span><span class="dv">3</span>, ]</span>
<span id="cb19-3"><a href="Chapter-3.html#cb19-3"></a></span>
<span id="cb19-4"><a href="Chapter-3.html#cb19-4"></a><span class="co">#Indiát és Fülöp-szigeteket összevonva csökken a VIF-mutató</span></span>
<span id="cb19-5"><a href="Chapter-3.html#cb19-5"></a>data_Asia<span class="op">$</span>country_alt &lt;-<span class="st"> </span>data_Asia<span class="op">$</span>country</span>
<span id="cb19-6"><a href="Chapter-3.html#cb19-6"></a>data_Asia[data_Asia<span class="op">$</span>country_alt<span class="op">==</span><span class="st">&quot;India&quot;</span>, <span class="st">&quot;country_alt&quot;</span>] &lt;-<span class="st"> &quot;Philippines&quot;</span></span>
<span id="cb19-7"><a href="Chapter-3.html#cb19-7"></a></span>
<span id="cb19-8"><a href="Chapter-3.html#cb19-8"></a>logit2 &lt;-<span class="st"> </span><span class="kw">glm</span>(died<span class="op">~</span>age<span class="op">+</span>sex<span class="op">+</span>chronic_disease_binary<span class="op">+</span>country_alt, <span class="dt">data=</span>data_Asia, <span class="dt">family=</span><span class="kw">binomial</span>(logit))</span>
<span id="cb19-9"><a href="Chapter-3.html#cb19-9"></a><span class="kw">summary</span>(logit2)</span></code></pre></div>
<pre><code>
Call:
glm(formula = died ~ age + sex + chronic_disease_binary + country_alt, 
    family = binomial(logit), data = data_Asia)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.3211  -0.6536  -0.3621  -0.0001   3.2244  

Coefficients:
                             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                -3.799e+00  3.607e-01 -10.531  &lt; 2e-16 ***
age                         7.146e-02  2.532e-03  28.224  &lt; 2e-16 ***
sexTRUE                     4.709e-01  7.723e-02   6.098 1.07e-09 ***
chronic_disease_binaryTRUE  2.129e+00  3.218e-01   6.617 3.66e-11 ***
country_altJapan           -1.678e+01  1.954e+03  -0.009    0.993    
country_altMalaysia        -1.739e+01  1.298e+03  -0.013    0.989    
country_altNepal           -1.652e+01  2.797e+03  -0.006    0.995    
country_altPhilippines     -1.394e+00  3.358e-01  -4.152 3.30e-05 ***
country_altSingapore       -1.736e+01  3.304e+02  -0.053    0.958    
country_altSouth Korea     -1.664e+01  8.145e+02  -0.020    0.984    
country_altThailand        -1.788e+01  2.797e+03  -0.006    0.995    
country_altVietnam         -1.891e+01  5.621e+02  -0.034    0.973    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 5835.2  on 5267  degrees of freedom
Residual deviance: 4348.6  on 5256  degrees of freedom
AIC: 4372.6

Number of Fisher Scoring iterations: 16</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="Chapter-3.html#cb21-1"></a><span class="kw">vif</span>(logit2)</span></code></pre></div>
<pre><code>                       age                    sexTRUE 
                  1.047368                   1.010986 
chronic_disease_binaryTRUE           country_altJapan 
                  1.090713                   1.057938 
       country_altMalaysia           country_altNepal 
                  1.085748                   1.029110 
    country_altPhilippines       country_altSingapore 
                  3.546896                   2.639480 
    country_altSouth Korea        country_altThailand 
                  1.285864                   1.028649 
        country_altVietnam 
                  1.438922 </code></pre>
</div>
<div id="nemlinearitás-vizsgálata-a-reset-teszttel" class="section level3">
<h3>Nemlinearitás vizsgálata a RESET-teszttel</h3>
<p>A linearitás teszteléséhez felhasználtuk a <strong>Ramsey-féle RESET-tesztet és a CR-plotokat</strong>.
Ezek alapján pedig a jelenlegi modellünk nemlineáris, amely miatt az életkor változót alakítjuk át.</p>
<p>Először az életkor átalakításával próbálkoztunk:
1. 35-nél megtörő CR-plot miatt annak bevétele a modellbe<br />
2. ötvenfelett dummy létrehozása<br />
</p>
<p>Mivel az első módszer sikerre vezetett, a másodikat nem próbáltuk meg.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="Chapter-3.html#cb23-1"></a><span class="co">#Linearitás tesztelése megmutatja, hogy még nem lineáris a modell</span></span>
<span id="cb23-2"><a href="Chapter-3.html#cb23-2"></a><span class="kw">resettest</span>(logit2, <span class="dt">type=</span><span class="st">&quot;regressor&quot;</span>)</span></code></pre></div>
<pre><code>
    RESET test

data:  logit2
RESET = 22.451, df1 = 6, df2 = 5250, p-value &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="Chapter-3.html#cb25-1"></a><span class="kw">crPlots</span>(logit2)</span></code></pre></div>
<p><img src="my-book_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="Chapter-3.html#cb26-1"></a><span class="kw">crPlots</span>(logit2, <span class="op">~</span>age)</span></code></pre></div>
<p><img src="my-book_files/figure-html/unnamed-chunk-17-2.png" width="672" /></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="Chapter-3.html#cb27-1"></a><span class="co">#Az életkor változó nagyjából 35 évnél törik meg, ezt kell belevennünk a modellbe</span></span>
<span id="cb27-2"><a href="Chapter-3.html#cb27-2"></a></span>
<span id="cb27-3"><a href="Chapter-3.html#cb27-3"></a>logit3 &lt;-<span class="st"> </span><span class="kw">glm</span>(died<span class="op">~</span>age<span class="op">+</span>sex<span class="op">+</span>chronic_disease_binary<span class="op">+</span>country_alt<span class="op">+</span><span class="kw">pmax</span>(age<span class="dv">-35</span>,<span class="dv">0</span>), <span class="dt">data=</span>data_Asia, <span class="dt">family=</span><span class="kw">binomial</span>(logit))</span>
<span id="cb27-4"><a href="Chapter-3.html#cb27-4"></a><span class="kw">summary</span>(logit3)</span></code></pre></div>
<pre><code>
Call:
glm(formula = died ~ age + sex + chronic_disease_binary + country_alt + 
    pmax(age - 35, 0), family = binomial(logit), data = data_Asia)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-2.34145  -0.63063  -0.37089  -0.00011   2.82050  

Coefficients:
                             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                  -2.58076    0.53148  -4.856 1.20e-06 ***
age                           0.03218    0.01329   2.421  0.01547 *  
sexTRUE                       0.47988    0.07761   6.183 6.28e-10 ***
chronic_disease_binaryTRUE    2.13050    0.32237   6.609 3.88e-11 ***
country_altJapan            -16.72685 1967.29686  -0.009  0.99322    
country_altMalaysia         -17.54875 1417.57052  -0.012  0.99012    
country_altNepal            -16.49485 2797.44196  -0.006  0.99530    
country_altPhilippines       -1.37796    0.33313  -4.136 3.53e-05 ***
country_altSingapore        -17.36252  335.74122  -0.052  0.95876    
country_altSouth Korea      -16.67985  837.13291  -0.020  0.98410    
country_altThailand         -17.81103 2797.44196  -0.006  0.99492    
country_altVietnam          -18.97497  575.60639  -0.033  0.97370    
pmax(age - 35, 0)             0.04405    0.01491   2.955  0.00313 ** 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 5835.2  on 5267  degrees of freedom
Residual deviance: 4340.9  on 5255  degrees of freedom
AIC: 4366.9

Number of Fisher Scoring iterations: 16</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="Chapter-3.html#cb29-1"></a><span class="kw">resettest</span>(logit3, <span class="dt">type=</span><span class="st">&quot;regressor&quot;</span>)</span></code></pre></div>
<pre><code>
    RESET test

data:  logit3
RESET = 0.44526, df1 = 8, df2 = 5247, p-value = 0.8943</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="Chapter-3.html#cb31-1"></a><span class="kw">crPlots</span>(logit3)</span></code></pre></div>
<p><img src="my-book_files/figure-html/unnamed-chunk-17-3.png" width="672" /></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="Chapter-3.html#cb32-1"></a><span class="kw">linearHypothesis</span>(logit3, <span class="kw">c</span>(<span class="st">&quot;country_altJapan=0&quot;</span>, <span class="st">&quot;country_altMalaysia=0&quot;</span>, <span class="st">&quot;country_altNepal=0&quot;</span>, <span class="st">&quot;country_altVietnam=0&quot;</span>, <span class="st">&quot;country_altSingapore=0&quot;</span>, <span class="st">&quot;country_altSouth Korea=0&quot;</span>, <span class="st">&quot;country_altThailand=0&quot;</span>))</span></code></pre></div>
<pre><code>Linear hypothesis test

Hypothesis:
country_altJapan = 0
country_altMalaysia = 0
country_altNepal = 0
country_altVietnam = 0
country_altSingapore = 0
country_altSouth Korea = 0
country_altThailand = 0

Model 1: restricted model
Model 2: died ~ age + sex + chronic_disease_binary + country_alt + pmax(age - 
    35, 0)

  Res.Df Df  Chisq Pr(&gt;Chisq)
1   5262                     
2   5255  7 0.0045          1</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="Chapter-3.html#cb34-1"></a>data_Asia<span class="op">$</span>fulopindia &lt;-<span class="st"> </span><span class="kw">as.logical</span>(data_Asia<span class="op">$</span>country_alt<span class="op">==</span><span class="st">&quot;Philippines&quot;</span>)</span></code></pre></div>
<p>Ezután a nem szignifikáns változók közül az országokat látjuk csak, így ezek
összevont elhagyását teszteljük, a Fülöp-szk. és Indiát kivéve.</p>
<p>Mivel a tesztnél p&gt;0,05, így ezeket a változót kidobhatjuk,
az új dummyval pedig elkészült a modellünk.</p>
<p>Az új modellben viszont az életkor változó átalakított formájában magas VIF-et okoz,
így <strong>az eredeti életkort - amely a kevésbé szignifikáns változó - kihagyjuk a modellből.</strong></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="Chapter-3.html#cb35-1"></a>logit4 &lt;-<span class="st"> </span><span class="kw">glm</span>(died<span class="op">~</span>age<span class="op">+</span>sex<span class="op">+</span>chronic_disease_binary<span class="op">+</span>fulopindia<span class="op">+</span><span class="kw">I</span>(<span class="kw">pmax</span>(age<span class="dv">-35</span>,<span class="dv">0</span>)), </span>
<span id="cb35-2"><a href="Chapter-3.html#cb35-2"></a>              <span class="dt">data=</span>data_Asia, <span class="dt">family=</span><span class="kw">binomial</span>(logit))</span>
<span id="cb35-3"><a href="Chapter-3.html#cb35-3"></a><span class="kw">summary</span>(logit4)</span></code></pre></div>
<pre><code>
Call:
glm(formula = died ~ age + sex + chronic_disease_binary + fulopindia + 
    I(pmax(age - 35, 0)), family = binomial(logit), data = data_Asia)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.3283  -0.6371  -0.3751  -0.2097   2.8072  

Coefficients:
                           Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                -4.56944    0.47649  -9.590  &lt; 2e-16 ***
age                         0.03081    0.01328   2.319  0.02039 *  
sexTRUE                     0.46982    0.07694   6.107 1.02e-09 ***
chronic_disease_binaryTRUE  2.09148    0.29034   7.203 5.87e-13 ***
fulopindiaTRUE              0.64892    0.21725   2.987  0.00282 ** 
I(pmax(age - 35, 0))        0.04610    0.01490   3.095  0.00197 ** 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 5835.2  on 5267  degrees of freedom
Residual deviance: 4428.9  on 5262  degrees of freedom
AIC: 4440.9

Number of Fisher Scoring iterations: 5</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="Chapter-3.html#cb37-1"></a><span class="kw">resettest</span>(logit4, <span class="dt">type=</span><span class="st">&quot;regressor&quot;</span>)</span></code></pre></div>
<pre><code>
    RESET test

data:  logit4
RESET = 0.41565, df1 = 10, df2 = 5252, p-value = 0.9399</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="Chapter-3.html#cb39-1"></a><span class="kw">vif</span>(logit4)</span></code></pre></div>
<pre><code>                       age                    sexTRUE 
                 13.751477                   1.008184 
chronic_disease_binaryTRUE             fulopindiaTRUE 
                  1.057303                   1.020537 
      I(pmax(age - 35, 0)) 
                 13.803814 </code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="Chapter-3.html#cb41-1"></a><span class="kw">linearHypothesis</span>(logit4, <span class="st">&quot;age&quot;</span>)</span></code></pre></div>
<pre><code>Linear hypothesis test

Hypothesis:
age = 0

Model 1: restricted model
Model 2: died ~ age + sex + chronic_disease_binary + fulopindia + I(pmax(age - 
    35, 0))

  Res.Df Df  Chisq Pr(&gt;Chisq)  
1   5263                       
2   5262  1 5.3783    0.02039 *
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="Chapter-3.html#cb43-1"></a>logit_final &lt;-<span class="st"> </span><span class="kw">glm</span>(died<span class="op">~</span>sex<span class="op">+</span>chronic_disease_binary<span class="op">+</span>fulopindia<span class="op">+</span><span class="kw">I</span>(<span class="kw">pmax</span>(age<span class="dv">-35</span>,<span class="dv">0</span>)), </span>
<span id="cb43-2"><a href="Chapter-3.html#cb43-2"></a>                   <span class="dt">data=</span>data_Asia, <span class="dt">family=</span><span class="kw">binomial</span>(logit))</span>
<span id="cb43-3"><a href="Chapter-3.html#cb43-3"></a><span class="kw">summary</span>(logit_final)</span></code></pre></div>
<pre><code>
Call:
glm(formula = died ~ sex + chronic_disease_binary + fulopindia + 
    I(pmax(age - 35, 0)), family = binomial(logit), data = data_Asia)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.3423  -0.6262  -0.4012  -0.2523   2.4918  

Coefficients:
                            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                -3.614952   0.227491 -15.891  &lt; 2e-16 ***
sexTRUE                     0.475936   0.077004   6.181 6.38e-10 ***
chronic_disease_binaryTRUE  2.097687   0.291009   7.208 5.66e-13 ***
fulopindiaTRUE              0.659963   0.217446   3.035   0.0024 ** 
I(pmax(age - 35, 0))        0.080474   0.002715  29.641  &lt; 2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 5835.2  on 5267  degrees of freedom
Residual deviance: 4435.0  on 5263  degrees of freedom
AIC: 4445

Number of Fisher Scoring iterations: 5</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="Chapter-3.html#cb45-1"></a><span class="kw">vif</span>(logit_final)</span></code></pre></div>
<pre><code>                   sexTRUE chronic_disease_binaryTRUE 
                  1.007962                   1.056893 
            fulopindiaTRUE       I(pmax(age - 35, 0)) 
                  1.017931                   1.044902 </code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="Chapter-3.html#cb47-1"></a><span class="kw">resettest</span>(logit_final, <span class="dt">type=</span><span class="st">&quot;regressor&quot;</span>)</span></code></pre></div>
<pre><code>
    RESET test

data:  logit_final
RESET = 0.31875, df1 = 8, df2 = 5255, p-value = 0.9593</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="Chapter-3.html#cb49-1"></a><span class="co">#Az együtthatók jelentése</span></span>
<span id="cb49-2"><a href="Chapter-3.html#cb49-2"></a><span class="kw">exp</span>(<span class="kw">coef</span>(logit_final))</span></code></pre></div>
<pre><code>               (Intercept)                    sexTRUE 
                0.02691822                 1.60952006 
chronic_disease_binaryTRUE             fulopindiaTRUE 
                8.14730002                 1.93472091 
      I(pmax(age - 35, 0)) 
                1.08380014 </code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="Chapter-3.html#cb51-1"></a><span class="kw">plotmo</span>(logit_final)</span></code></pre></div>
<pre><code> plotmo grid:    sex chronic_disease_binary fulopindia age
                TRUE                  FALSE       TRUE  46</code></pre>
<p><img src="my-book_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>Az átalakított modellünk megfelel minden feltevésnek és tesztnek, így ennek
együtthatóit értelmezhetjük:<br />
-<strong>cet. par. a férfi lét 1,61-szeresére növeli a halálozás oddsának értékét</strong><br />
-<strong>cet. par. a krónikus betegség megléte 8,15-szeresére növeli a halálozás oddsának értékét</strong><br />
-<strong>cet. par. a Fülöp-szk-n vagy Indiában való állampolgárság 1,95-szeresére növeli a halálozás oddsának értékét</strong><br />
-<strong>cet. par. a 35 évnél idősebb embereknek 1,08-szor nagyobb a halálozás oddsának értéke</strong><br />
</p>
</div>
<div id="előrejelzés-a-kiválasztott-modellel" class="section level3">
<h3>Előrejelzés a kiválasztott modellel</h3>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="Chapter-3.html#cb53-1"></a>deathval &lt;-<span class="st"> </span><span class="kw">predict</span>(logit_final, data_Asia, <span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb53-2"><a href="Chapter-3.html#cb53-2"></a>data_Asia<span class="op">$</span>deathval &lt;-<span class="st"> </span>deathval</span>
<span id="cb53-3"><a href="Chapter-3.html#cb53-3"></a>data_Asia<span class="op">$</span>becsult &lt;-<span class="st"> </span><span class="kw">ifelse</span>(deathval<span class="op">&gt;</span><span class="fl">0.5</span>, <span class="st">&quot;TRUE&quot;</span>, <span class="st">&quot;FALSE&quot;</span>)</span>
<span id="cb53-4"><a href="Chapter-3.html#cb53-4"></a><span class="kw">xtabs</span>(<span class="op">~</span>died<span class="op">+</span>becsult, <span class="dt">data=</span>data_Asia)</span></code></pre></div>
<pre><code>       becsult
died    FALSE TRUE
  FALSE  3674  317
  TRUE    766  511</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="Chapter-3.html#cb55-1"></a>fin_perc &lt;-<span class="st"> </span><span class="kw">sum</span>(data_Asia<span class="op">$</span>died<span class="op">==</span>data_Asia<span class="op">$</span>becsult)<span class="op">/</span><span class="kw">nrow</span>(data_Asia)<span class="op">*</span><span class="dv">100</span></span></code></pre></div>
<p>A próba 50%-os cutoff értéknél a modell 79.4419134%-ban helyes eredményt ad.</p>
<p><img src="my-book_files/figure-html/unnamed-chunk-23-1.png" width="672" /><img src="my-book_files/figure-html/unnamed-chunk-23-2.png" width="672" /></p>
<p>Az ROC-görbe GINI-mutatója 0.6554136.
A modellünk kalibrálása során a másodfajú hiba súlya 3, így a
simított költségfüggvény alapján a 0.2960607 lesz az optimális küszöbérték.</p>
<pre><code>       becsult_final
died    FALSE TRUE
  FALSE  3197  794
  TRUE    405  872</code></pre>
<p>Az optimális küszöbértéknél a klasszifikáció pontossága 77.2399393% lesz.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="Chapter-2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="Chapter-4.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/MarcellGranat/COVID/blob/main/Chapter-3.Rmd",
"text": "Jump to GitHub"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
