[
["index.html", "A COVID j√°rv√°ny elemz√©se t√∂bb√°ltoz√≥s statisztikai eszk√∂zkkel Mi ez a projekt?", " A COVID j√°rv√°ny elemz√©se t√∂bb√°ltoz√≥s statisztikai eszk√∂zkkel Gran√°t Marcell &amp; Mazzag B√°lint Mi ez a projekt? A tanulm√°ny a Budapesti Corvinus Egyetem T√∂bbv√°ltoz√≥s adatelemz√©s t√°rgy keret√©ben k√©sz√ºlt. K√©zirat lez√°r√°s√°nak d√°tuma: 2021. janu√°r 3. A k√©zirat tartalm√°hoz f≈±z√∂d≈ë tudom√°nyos diszkusszi√≥ t√°mogat√°sa √©rdek√©ben egy p√°rbesz√©d ablak ker√ºlt megnyit√°sra az anyagokat tartalmaz√≥ GitHub repository oldal√°n: https://github.com/MarcellGranat/COVID/discussions p { text-align: justify; } .author { font-size: 20px; text-align: center; } .title { text-align: center; } "],
["Chapter-2.html", "D√∂nt√©si fa Adatok bemutat√°sa Modellbecsl√©s", " D√∂nt√©si fa p { text-align: justify; } Az egyik tal√°n legfontosabb k√©rd√©s a j√°rv√°ny√ºgyben, hogy mennyire hal√°los a v√≠rus. M√°r a megjelen√©sekor nagyon hamar ismertt√© v√°lt a t√©ny: els≈ësorban az id≈ësekre √©s kr√≥nikus betegre jelent kock√°zatot. Ennek a t√©nynek empirikus tesztel√©s√©hez olyan adatt√°bl√°ra van sz√ºks√©g√ºnk, melyben r√∂gz√≠t√©sre ker√ºlnek a megfert≈ëz√∂ttek demogr√°fiai adatai √©s az eset v√©gs≈ë kimenete (ezt a fajta adatt√≠pust nevezik ‚Äúline list‚Äù-nek). Adatok bemutat√°sa Forr√°s A fentebb le√≠rt c√©lra lett l√©trehozva egy ny√≠lt projekt1, amely sor√°n ezeket az adatokat t√∂bb orsz√°gra gy≈±jtik ki √©s teszi online el√©rhet≈ëv√©. dat &lt;- vroom::vroom(&#39;latestdata.csv&#39;) Az adatt√°bla √∂sszesen 2676311 megfigyel√©st tartalmaz 33 v√°ltoz√≥val. Azonban a v√°ltoz√≥k jelent≈ës r√©sze haszn√°lhatatlan elemz√©sre √©s jelent≈ës m√©rt√©kben van sz√ºks√©g az adatok tiszt√≠t√°s√°ra is. Egyetlen p√©lda eml√≠t√©sek√©nt a kimenetben nem egyszer≈±en died vagy elhunyt szerepelt, hanem annak sz√°mos szinon√≠m√°ja is, amelett, hogy sok esetben nincs el√©rhet≈ë adat. set.seed(1) dat %&gt;% count(outcome) %&gt;% na.omit() %&gt;% {mutate(., s = runif(n = nrow(.)))} %&gt;% ggplot(aes(label = outcome, size = s)) + geom_text_wordcloud(color = &#39;aquamarine4&#39;) + labs(title = &quot;Az nyers adatt√°bl√°ban a kimenet v√°ltoz√≥ √°ltal felvett √©rt√©kek&quot;) + theme_minimal() Adatok elemz√©shez val√≥ el≈ëk√©sz√≠t√©se Az adatok megtisz√≠t√°sa el≈ëtt el kell d√∂nten√ºnk, hogy mely v√°ltoz√≥kkal is √©rdemes foglalkozni, mivel sajnos sz√°mos v√°ltoz√≥ eset√©ben hi√°nyzik rengeteg sor a t√°bl√°ban. dat %&gt;% apply(2, function(x) sum(is.na(x))) %&gt;% {data.frame(var = names(.), nobs = nrow(dat)-., robs = (nrow(dat)-.)/nrow(dat))} %&gt;% set_names(&#39;var&#39;, &#39;Hi√°nytalan adatok sz√°ma&#39;, &#39;Hi√°nytalanok ar√°nya&#39;) %&gt;% gt( rowname_col = &quot;var&quot; ) %&gt;% fmt_percent( columns = vars(&#39;Hi√°nytalanok ar√°nya&#39;), dec_mark = &#39;,&#39; ) %&gt;% tab_header(title = &#39;Adatt√°bl√°ban l√©v≈ë hi√°nytalan megfigyel√©sek ar√°nya&#39;) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #pamufqigws .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #pamufqigws .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #pamufqigws .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #pamufqigws .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #pamufqigws .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #pamufqigws .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #pamufqigws .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #pamufqigws .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #pamufqigws .gt_column_spanner_outer:first-child { padding-left: 0; } #pamufqigws .gt_column_spanner_outer:last-child { padding-right: 0; } #pamufqigws .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #pamufqigws .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #pamufqigws .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #pamufqigws .gt_from_md > :first-child { margin-top: 0; } #pamufqigws .gt_from_md > :last-child { margin-bottom: 0; } #pamufqigws .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #pamufqigws .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #pamufqigws .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #pamufqigws .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #pamufqigws .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #pamufqigws .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #pamufqigws .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #pamufqigws .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #pamufqigws .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #pamufqigws .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #pamufqigws .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #pamufqigws .gt_sourcenote { font-size: 90%; padding: 4px; } #pamufqigws .gt_left { text-align: left; } #pamufqigws .gt_center { text-align: center; } #pamufqigws .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #pamufqigws .gt_font_normal { font-weight: normal; } #pamufqigws .gt_font_bold { font-weight: bold; } #pamufqigws .gt_font_italic { font-style: italic; } #pamufqigws .gt_super { font-size: 65%; } #pamufqigws .gt_footnote_marks { font-style: italic; font-size: 65%; } Adatt√°bl√°ban l√©v≈ë hi√°nytalan megfigyel√©sek ar√°nya Hi√°nytalan adatok sz√°ma Hi√°nytalanok ar√°nya ID 2676311 100,00&percnt; age 578018 21,60&percnt; sex 580157 21,68&percnt; city 1698630 63,47&percnt; province 2223647 83,09&percnt; country 2676196 100,00&percnt; latitude 2676250 100,00&percnt; longitude 2676250 100,00&percnt; geo_resolution 2676250 100,00&percnt; date_onset_symptoms 261599 9,77&percnt; date_admission_hospital 116211 4,34&percnt; date_confirmation 2567822 95,95&percnt; symptoms 0 0,00&percnt; lives_in_Wuhan 0 0,00&percnt; travel_history_dates 2611 0,10&percnt; travel_history_location 9222 0,34&percnt; reported_market_exposure 0 0,00&percnt; additional_information 45855 1,71&percnt; chronic_disease_binary 2676311 100,00&percnt; chronic_disease 0 0,00&percnt; source 2109347 78,82&percnt; sequence_available 0 0,00&percnt; outcome 307382 11,49&percnt; date_death_or_discharge 0 0,00&percnt; notes_for_discussion 0 0,00&percnt; location 13376 0,50&percnt; admin3 80434 3,01&percnt; admin2 826054 30,87&percnt; admin1 1257558 46,99&percnt; country_new 2645758 98,86&percnt; admin_id 2676250 100,00&percnt; data_moderator_initials 1742983 65,13&percnt; travel_history_binary 2610732 97,55&percnt; Az adatok hi√°nyoss√°g√°nak √©s felhaszn√°lhat√≥s√°g√°nak figyelembev√©tel√©vel az al√°bbi v√°ltoz√≥kat √©rdemes bevonni a modellbe: - √©letkor - nem - orsz√°g - van-e kr√≥nikus betegs√©ge - fert≈ëz≈ëd√∂tts√©g kimutat√°s√°nak ideje - f√∂ldrajzi sz√©less√©g - f√∂ldrajzi hossz√∫s√°g - megbeteged√©s kimenete A v√°ltoz√≥k tiszt√≠t√°sa sor√°n egyik legfontosabb, hogy a kimenet oszlopban √∂sszevontuk minden elhal√°loz√°sra megfelel≈ë szinon√≠m√°t egys√©gesen az elhunyt kateg√≥ri√°ba, √©s minden fel√©p√ºltnek megfelel≈ët a fel√©p√ºltbe. Mivel jelen elemz√©s kutat√°si k√©rd√©se, hogy mi a val√≥sz√≠n≈±s√©ge, hogy valaki t√∫l√©li, √≠gy elvetett√ºnk minden megfigyel√©st, amely eset√©ben az alany m√©g betegs√©g alatt √°ll, vagy a kimenet ismeretlen. Az orsz√°g oszlopb√≥l kontinensk√©nt √∫j magyar√°z√≥ v√°ltoz√≥t hat√°roztunk meg, √©s az √©vek eset√©ben ismeretlennek vet√ºk azokat, ahol intervallum ker√ºlt megad√°sra2. dat %&gt;% select(outcome, age, sex, country, chronic_disease_binary, latitude, longitude, date_confirmation) %&gt;% mutate( continent = countrycode::countrycode(country, origin = &#39;country.name&#39;, destination = &#39;continent&#39;), date = as.numeric(difftime(time1 = lubridate::dmy(date_confirmation), time2 = lubridate::dmy(&quot;01/01/2020&quot;), units = &#39;days&#39;)), age = as.numeric(ifelse(str_detect(age, &#39;-&#39;), NA, age)) ) %&gt;% mutate( # cleaning the depedent var outcome = case_when( outcome == &#39;death&#39; ~ &#39;died&#39;, outcome == &#39;died&#39; ~ &#39;died&#39;, outcome == &#39;Death&#39; ~ &#39;died&#39;, outcome == &#39;dead&#39; ~ &#39;died&#39;, outcome == &#39;Dead&#39; ~ &#39;died&#39;, outcome == &#39;Died&#39; ~ &#39;died&#39;, outcome == &#39;Deceased&#39; ~ &#39;died&#39;, outcome == &#39;discharge&#39; ~ &#39;survived&#39;, outcome == &#39;discharged&#39; ~ &#39;survived&#39;, outcome == &#39;Discharged&#39; ~ &#39;survived&#39;, outcome == &#39;Discharged from hospital&#39; ~ &#39;survived&#39;, outcome == &#39;recovered&#39; ~ &#39;survived&#39;, outcome == &#39;released from quarantine&#39; ~ &#39;survived&#39;, outcome == &#39;recovered&#39; ~ &#39;survived&#39;, outcome == &#39;Recovered&#39; ~ &#39;survived&#39;, outcome == &#39;Recovered&#39; ~ &#39;survived&#39;, outcome == &#39;Recovered&#39; ~ &#39;survived&#39;, T ~ &#39;NA&#39; ) ) %&gt;% filter(outcome != &#39;NA&#39;) %&gt;% mutate( died = outcome == &#39;died&#39; ) %&gt;% select(-outcome, -date_confirmation) %&gt;% {dat &lt;&lt;- .} Az √≠gy kapott √∫j adatt√°bl√°ban m√°r csup√°n 2676311 megfigyel√©s √©s 33 v√°ltoz√≥ szerepel. dat %&gt;% head %&gt;% gt %&gt;% tab_header(title = &#39;Adatt√°bla modellez√©sre el≈ëk√©sz√≠tve&#39;) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #vrzpkjgsbj .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #vrzpkjgsbj .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #vrzpkjgsbj .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #vrzpkjgsbj .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #vrzpkjgsbj .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #vrzpkjgsbj .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #vrzpkjgsbj .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #vrzpkjgsbj .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #vrzpkjgsbj .gt_column_spanner_outer:first-child { padding-left: 0; } #vrzpkjgsbj .gt_column_spanner_outer:last-child { padding-right: 0; } #vrzpkjgsbj .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #vrzpkjgsbj .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #vrzpkjgsbj .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #vrzpkjgsbj .gt_from_md > :first-child { margin-top: 0; } #vrzpkjgsbj .gt_from_md > :last-child { margin-bottom: 0; } #vrzpkjgsbj .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #vrzpkjgsbj .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #vrzpkjgsbj .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #vrzpkjgsbj .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #vrzpkjgsbj .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #vrzpkjgsbj .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #vrzpkjgsbj .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #vrzpkjgsbj .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #vrzpkjgsbj .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #vrzpkjgsbj .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #vrzpkjgsbj .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #vrzpkjgsbj .gt_sourcenote { font-size: 90%; padding: 4px; } #vrzpkjgsbj .gt_left { text-align: left; } #vrzpkjgsbj .gt_center { text-align: center; } #vrzpkjgsbj .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #vrzpkjgsbj .gt_font_normal { font-weight: normal; } #vrzpkjgsbj .gt_font_bold { font-weight: bold; } #vrzpkjgsbj .gt_font_italic { font-style: italic; } #vrzpkjgsbj .gt_super { font-size: 65%; } #vrzpkjgsbj .gt_footnote_marks { font-style: italic; font-size: 65%; } Adatt√°bla modellez√©sre el≈ëk√©sz√≠tve ID age sex city province country latitude longitude geo_resolution date_onset_symptoms date_admission_hospital date_confirmation symptoms lives_in_Wuhan travel_history_dates travel_history_location reported_market_exposure additional_information chronic_disease_binary chronic_disease source sequence_available outcome date_death_or_discharge notes_for_discussion location admin3 admin2 admin1 country_new admin_id data_moderator_initials travel_history_binary 000-1-1 NA male Shek Lei Hong Kong China 22.36502 114.13381 point NA NA 14.02.2020 NA NA 22.01.2020 China NA Case 55; mainland China travel via the Lok Ma Chau border crossing FALSE NA https://www.scmp.com/news/hong-kong/health-environment/article/3050681/coronavirus-hong-kong-confirms-three-news-cases NA critical condition, intubated as of 14.02.2020 NA NA Shek Lei NA NA Hong Kong China 8029 NA NA 000-1-10 78 male Vo Euganeo Veneto Italy 45.29775 11.65838 point NA NA 21.02.2020 NA NA NA NA NA Hospitalized on 12.02.2020 for other reasons FALSE NA https://www.corriere.it/cronache/20_febbraio_21/coronavirus-italia-cosa-sappiamo-casi-codogno-lombardia-27fa736c-548b-11ea-9196-da7d305401b7.shtml NA death NA NA Vo' Euganeo NA NA Veneto Italy 8954 NA NA 000-1-100 61 female NA NA Singapore 1.35346 103.81510 admin0 NA NA 14.02.2020 NA NA NA NA NA Case 65; family member of Case 50, a DBS employee, as is Case 55 FALSE NA https://www.channelnewsasia.com/news/singapore/coronavirus-covid-19-singapore-cases-grace-assembly-of-god--12434646 https://bnonews.com/wp-content/uploads/2020/02/2172020Cases.pdf NA discharge NA NA NA NA NA NA Singapore 200 NA NA 000-1-1000 NA NA Zhengzhou City Henan China 34.62931 113.46800 admin2 NA NA 26.01.2020 NA NA NA NA NA NA FALSE NA https://news.163.com/special/epidemic/?spssid=7283291fcdba1d8c2d13ee3da2cfb760&amp;spsw=7&amp;spss=other NA NA NA NA NA NA Zhengzhou City Henan China 10091 NA NA 000-1-10000 NA NA Pingxiang City Jiangxi China 27.51356 113.90290 admin2 NA NA 14.02.2020 NA NA NA NA NA NA FALSE NA http://hc.jiangxi.gov.cn/doc/2020/02/15/138898.shtml NA NA NA NA NA NA Pingxiang City Jiangxi China 7060 NA NA 000-1-10001 NA NA Yichun City Jiangxi China 28.30755 114.97320 admin2 NA NA 14.02.2020 NA NA NA NA NA NA FALSE NA http://hc.jiangxi.gov.cn/doc/2020/02/15/138898.shtml NA NA NA NA NA NA Yichun City Jiangxi China 9794 NA NA dat %&gt;% select(age, sex, died) %&gt;% GGally::ggpairs(mapping = aes(color = died), title = &#39;√âletkor, nem √©s az elhal√°loz√°s kapcsolata&#39;) Error: Can&#39;t subset columns that don&#39;t exist. [31mx[39m Column `died` doesn&#39;t exist. dat %&gt;% select(continent, date, died) %&gt;% GGally::ggpairs(aes(color = died), title = &#39;A kontinens a r√∂gz√≠t√©s d√°tuma √©s az elhal√°loz√°s kapcsolata&#39;) Error: Can&#39;t subset columns that don&#39;t exist. [31mx[39m Column `continent` doesn&#39;t exist. Az √°br√°kb√≥l sajnos gyorsan kider√ºl, hogy a kimeneti adatra val√≥ r√°sz≈±r√©st k√∂vet≈ëen az adatt√°bl√°ban m√°r j√≥r√©szt csak √°zsiai orsz√°gok k√©pviseltetik magukat. M√°s kontintensekr≈ël sz√°rmaz√≥ adatok eset√©ben ez az oszlop nem ker√ºlt megfelel≈ëen dokument√°l√°sra. dat %&gt;% group_by(continent, country) %&gt;% summarise(n = n()) %&gt;% ungroup() %&gt;% na.omit() %&gt;% mutate( r = n/nrow(dat) ) %&gt;% arrange(continent) %&gt;% set_names(&#39;continent&#39;, &#39;country&#39;, &#39;n&#39;, &#39;n/sum(n)&#39;) %&gt;% gt( rowname_col = &#39;country&#39;, groupname_col = &#39;continent&#39; ) %&gt;% fmt_percent( columns = &#39;n/sum(n)&#39;, ) %&gt;% summary_rows(groups = T, columns = vars(n), fns = list(TOTAL = &#39;sum&#39;)) %&gt;% summary_rows(groups = T, columns = vars(&#39;n/sum(n)&#39;), fns = list(TOTAL = &#39;sum&#39;), formatter = fmt_percent) %&gt;% tab_options( summary_row.background.color = &quot;#ACEACE&quot;, row_group.background.color = &quot;#FFEFDB&quot; ) %&gt;% tab_header(title = &#39;Megfigyel√©sek sz√°ma orsz√°gonk√©nt&#39;, subtitle = &#39;Els≈ëdleges adattiszt√≠t√°s ut√°n&#39;) Error: Must group by variables found in `.data`. * Column `continent` is not found. A t√°bl√°zatb√≥l j√≥l l√°that√≥, hogy a legt√∂bb felhaszn√°lhat√≥ megfigyel√©s√ºnk Indi√°b√≥l sz√°rmazik. Logikusnak t≈±nik egy dummy v√°ltoz√≥t l√©trehozni ez√©rt Indi√°ra (india = {TRUE, ha Indi√°b√≥l sz√°rmazik, FALSE egy√©bk√©nt}). Indi√°ra val√≥ kontrol√°l√°s elm√©leti megfontol√°sb√≥l is helyesnek hangzik, figyelembe v√©ve, hogy az orsz√°g rendk√≠v√ºl szeg√©ny, a v√°rosok zs√∫foltak, orvosokb√≥l √©s felszerel√©sb≈ël, pedig hi√°ny van. Kor√°bban a spanyol n√°tha idej√©n is kiugr√≥an magas volt Indi√°ban a hal√°loz√°s3. dat %&gt;% mutate( india = country == &#39;India&#39; ) %&gt;% select(-country, -continent, -latitude, -longitude) %&gt;% {dat &lt;&lt;- .} dat %&gt;% head() %&gt;% gt %&gt;% tab_header(title = &#39;V√©gs≈ë adatt√°bla modellez√©shez&#39;) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #gxuvhaszck .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #gxuvhaszck .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #gxuvhaszck .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #gxuvhaszck .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #gxuvhaszck .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #gxuvhaszck .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #gxuvhaszck .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #gxuvhaszck .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #gxuvhaszck .gt_column_spanner_outer:first-child { padding-left: 0; } #gxuvhaszck .gt_column_spanner_outer:last-child { padding-right: 0; } #gxuvhaszck .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #gxuvhaszck .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #gxuvhaszck .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #gxuvhaszck .gt_from_md > :first-child { margin-top: 0; } #gxuvhaszck .gt_from_md > :last-child { margin-bottom: 0; } #gxuvhaszck .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #gxuvhaszck .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #gxuvhaszck .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #gxuvhaszck .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #gxuvhaszck .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #gxuvhaszck .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #gxuvhaszck .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #gxuvhaszck .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #gxuvhaszck .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #gxuvhaszck .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #gxuvhaszck .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #gxuvhaszck .gt_sourcenote { font-size: 90%; padding: 4px; } #gxuvhaszck .gt_left { text-align: left; } #gxuvhaszck .gt_center { text-align: center; } #gxuvhaszck .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #gxuvhaszck .gt_font_normal { font-weight: normal; } #gxuvhaszck .gt_font_bold { font-weight: bold; } #gxuvhaszck .gt_font_italic { font-style: italic; } #gxuvhaszck .gt_super { font-size: 65%; } #gxuvhaszck .gt_footnote_marks { font-style: italic; font-size: 65%; } V√©gs≈ë adatt√°bla modellez√©shez ID age sex city province country latitude longitude geo_resolution date_onset_symptoms date_admission_hospital date_confirmation symptoms lives_in_Wuhan travel_history_dates travel_history_location reported_market_exposure additional_information chronic_disease_binary chronic_disease source sequence_available outcome date_death_or_discharge notes_for_discussion location admin3 admin2 admin1 country_new admin_id data_moderator_initials travel_history_binary 000-1-1 NA male Shek Lei Hong Kong China 22.36502 114.13381 point NA NA 14.02.2020 NA NA 22.01.2020 China NA Case 55; mainland China travel via the Lok Ma Chau border crossing FALSE NA https://www.scmp.com/news/hong-kong/health-environment/article/3050681/coronavirus-hong-kong-confirms-three-news-cases NA critical condition, intubated as of 14.02.2020 NA NA Shek Lei NA NA Hong Kong China 8029 NA NA 000-1-10 78 male Vo Euganeo Veneto Italy 45.29775 11.65838 point NA NA 21.02.2020 NA NA NA NA NA Hospitalized on 12.02.2020 for other reasons FALSE NA https://www.corriere.it/cronache/20_febbraio_21/coronavirus-italia-cosa-sappiamo-casi-codogno-lombardia-27fa736c-548b-11ea-9196-da7d305401b7.shtml NA death NA NA Vo' Euganeo NA NA Veneto Italy 8954 NA NA 000-1-100 61 female NA NA Singapore 1.35346 103.81510 admin0 NA NA 14.02.2020 NA NA NA NA NA Case 65; family member of Case 50, a DBS employee, as is Case 55 FALSE NA https://www.channelnewsasia.com/news/singapore/coronavirus-covid-19-singapore-cases-grace-assembly-of-god--12434646 https://bnonews.com/wp-content/uploads/2020/02/2172020Cases.pdf NA discharge NA NA NA NA NA NA Singapore 200 NA NA 000-1-1000 NA NA Zhengzhou City Henan China 34.62931 113.46800 admin2 NA NA 26.01.2020 NA NA NA NA NA NA FALSE NA https://news.163.com/special/epidemic/?spssid=7283291fcdba1d8c2d13ee3da2cfb760&amp;spsw=7&amp;spss=other NA NA NA NA NA NA Zhengzhou City Henan China 10091 NA NA 000-1-10000 NA NA Pingxiang City Jiangxi China 27.51356 113.90290 admin2 NA NA 14.02.2020 NA NA NA NA NA NA FALSE NA http://hc.jiangxi.gov.cn/doc/2020/02/15/138898.shtml NA NA NA NA NA NA Pingxiang City Jiangxi China 7060 NA NA 000-1-10001 NA NA Yichun City Jiangxi China 28.30755 114.97320 admin2 NA NA 14.02.2020 NA NA NA NA NA NA FALSE NA http://hc.jiangxi.gov.cn/doc/2020/02/15/138898.shtml NA NA NA NA NA NA Yichun City Jiangxi China 9794 NA NA Modellbecsl√©s rpart1 &lt;- rpart::rpart(dat, formula = died ~ ., cp = .01) rattle::fancyRpartPlot(rpart1, palettes = &#39;OrRd&#39;, sub = &#39;cp = .01&#39;, main = &#39;1. d√∂nt√©si fa&#39;) A komplexit√°si param√©ter .01-nek v√°lasztva a d√∂nt√©si f√°nk egyetlen bont√°sb√≥l √°ll: ‚ÄúKisebb-e az √©letkor, mint 60?‚Äù. Az eredm√©ny valid√°lhat√≥ is azzal, ha megfigyelj√ºk, hogy mik√©nt v√°ltozik a mint√°ban szerepl≈ë hal√°loz√°si r√°ta √©letkoroknk√©nt. dat %&gt;% group_by(age) %&gt;% summarise(deathr = mean(died)) %&gt;% ggplot(aes(age, deathr)) + geom_point(shape = 21, fill = &#39;coral&#39;, alpha = .7, color = &#39;black&#39;) + geom_smooth() + labs(title = &#39;Az √©letkor √©s a hal√°loz√°si r√°ta k√∂z√∂tt √∂sszef√ºgg√©s&#39;, x = &#39;√©letkor&#39;, y = &#39;hal√°loz√°si r√°ta&#39;) Error: Problem with `summarise()` input `deathr`. x object &#39;died&#39; not found i Input `deathr` is `mean(died)`. i The error occured in group 1: age = &quot;0&quot;. Mindazon√°ltal ismerve, hogy a megfigyel√©sek NA-a t√∫l√©lte a v√≠rust, √≠gy √©rdemes lehet kisebb komplexit√°si param√©tert v√°lasztani. rpart2 &lt;- rpart::rpart(dat, formula = died ~ ., cp = .003) rattle::fancyRpartPlot(rpart2, palettes = &#39;OrRd&#39;, # plot sub = &#39;cp = .003&#39;, main = &#39;2. d√∂nt√©si fa&#39;) Open COVID-19 Data Working Group, Detailed Epidemiological Data from the COVID-19 Outbreak, http://virological.org/t/epidemiological-data-from-the-ncov-2019-outbreak-early-descriptions-from-publicly-available-data/337, let√∂ltve: 2020.12.28.‚Ü©Ô∏é Az intervallumok hossza nem egyezett meg.‚Ü©Ô∏é https://www.economist.com/asia/2020/03/21/if-covid-19-takes-hold-in-india-the-toll-will-be-grim‚Ü©Ô∏é "],
["Chapter-3.html", "Logit-modell Logit modell kalibr√°l√°sa", " Logit-modell p { text-align: justify; } A logit-modell √©p√≠t√©se sor√°n az a legfontosabb feladatunk, hogy a megfert≈ëz≈ëd√∂tt egy√©nek param√©terei alapj√°n megbecs√ºlj√ºk a hal√°loz√°suk val√≥sz√≠n≈±s√©g√©t. Mint tapasztalhattuk, legink√°bb az id≈ësebb koroszt√°lyt √©rintette s√∫lyosabban a v√≠rus, de az √©letkoron k√≠v√ºl felhaszn√°ljuk m√©g az orsz√°gokat, √©s a nemet is. A bemutatott adatt√°bla torz√≠totts√°ga miatt a modell√ºnkben csak √°zsiai orsz√°gok adatait haszn√°ljuk, √≠gy a kontinens v√°ltoz√≥j√°t nem, csak az orsz√°gok√©t haszn√°ltuk. Logit modell kalibr√°l√°sa Outlierek √©s VIF mutat√≥ szerinti elemz√©s Philippines India Singapore China Vietnam South Korea 4503 521 118 76 32 20 Malaysia Japan Nepal 6 4 2 L√°thatjuk, hogy a legt√∂bb megfigyel√©st F√ºl√∂p-szigetek √©s India adja A v√°ltoz√≥k tiszt√≠t√°s√°nak l√©p√©sei: -el≈ësz√∂r az alapmodell√ºnk sor√°n kirajzol√≥dott outliereket sz≈±rj√ºk ki -az orsz√°gok k√∂z√ºl India √©s a F√ºl√∂p-szigetek rendelkezik nagy VIF-mutat√≥val, √≠gy ezeket √∂sszevonjuk, ezzel elt√ºntetve a magas VIF-√©rt√©keket #Orsz√°gok k√∂z√ºl India √©s F√ºl√∂p-szigetek rendelkezik magas VIF-el logit &lt;- glm(died~age+sex+country+chronic_disease_binary, data=data_Asia, family=binomial(logit)) summary(logit) Call: glm(formula = died ~ age + sex + country + chronic_disease_binary, family = binomial(logit), data = data_Asia) Deviance Residuals: Min 1Q Median 3Q Max -3.1615 -0.5805 -0.3187 -0.0001 3.2810 Coefficients: Estimate Std. Error z value Pr(&gt;|z|) (Intercept) -3.849e+00 3.614e-01 -10.652 &lt; 2e-16 *** age 6.925e-02 2.634e-03 26.291 &lt; 2e-16 *** sexTRUE 3.587e-01 8.271e-02 4.337 1.44e-05 *** countryIndia 1.312e+00 3.504e-01 3.745 0.00018 *** countryJapan -1.654e+01 1.958e+03 -0.008 0.99326 countryMalaysia -1.717e+01 1.347e+03 -0.013 0.98983 countryNepal -1.629e+01 2.797e+03 -0.006 0.99535 countryPhilippines -1.529e+00 3.325e-01 -4.597 4.29e-06 *** countrySingapore -1.715e+01 3.343e+02 -0.051 0.95910 countrySouth Korea -1.643e+01 8.259e+02 -0.020 0.98413 countryThailand -1.761e+01 2.797e+03 -0.006 0.99498 countryVietnam -1.880e+01 5.651e+02 -0.033 0.97347 chronic_disease_binaryTRUE 2.331e+00 3.038e-01 7.674 1.67e-14 *** --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 (Dispersion parameter for binomial family taken to be 1) Null deviance: 5875.9 on 5283 degrees of freedom Residual deviance: 3889.3 on 5271 degrees of freedom AIC: 3915.3 Number of Fisher Scoring iterations: 16 vif(logit) age sexTRUE 1.064698 1.017816 countryIndia countryJapan 7.529853 1.056988 countryMalaysia countryNepal 1.084271 1.028635 countryPhilippines countrySingapore 9.458835 2.610870 countrySouth Korea countryThailand 1.280892 1.028172 countryVietnam chronic_disease_binaryTRUE 1.429719 1.104861 #Outlierek lesz≈±r√©se data_Asia &lt;- data_Asia[abs(rstudent(logit))&lt;3, ] #Indi√°t √©s F√ºl√∂p-szigeteket √∂sszevonva cs√∂kken a VIF-mutat√≥ data_Asia$country_alt &lt;- data_Asia$country data_Asia[data_Asia$country_alt==&quot;India&quot;, &quot;country_alt&quot;] &lt;- &quot;Philippines&quot; logit2 &lt;- glm(died~age+sex+chronic_disease_binary+country_alt, data=data_Asia, family=binomial(logit)) summary(logit2) Call: glm(formula = died ~ age + sex + chronic_disease_binary + country_alt, family = binomial(logit), data = data_Asia) Deviance Residuals: Min 1Q Median 3Q Max -2.3211 -0.6536 -0.3621 -0.0001 3.2244 Coefficients: Estimate Std. Error z value Pr(&gt;|z|) (Intercept) -3.799e+00 3.607e-01 -10.531 &lt; 2e-16 *** age 7.146e-02 2.532e-03 28.224 &lt; 2e-16 *** sexTRUE 4.709e-01 7.723e-02 6.098 1.07e-09 *** chronic_disease_binaryTRUE 2.129e+00 3.218e-01 6.617 3.66e-11 *** country_altJapan -1.678e+01 1.954e+03 -0.009 0.993 country_altMalaysia -1.739e+01 1.298e+03 -0.013 0.989 country_altNepal -1.652e+01 2.797e+03 -0.006 0.995 country_altPhilippines -1.394e+00 3.358e-01 -4.152 3.30e-05 *** country_altSingapore -1.736e+01 3.304e+02 -0.053 0.958 country_altSouth Korea -1.664e+01 8.145e+02 -0.020 0.984 country_altThailand -1.788e+01 2.797e+03 -0.006 0.995 country_altVietnam -1.891e+01 5.621e+02 -0.034 0.973 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 (Dispersion parameter for binomial family taken to be 1) Null deviance: 5835.2 on 5267 degrees of freedom Residual deviance: 4348.6 on 5256 degrees of freedom AIC: 4372.6 Number of Fisher Scoring iterations: 16 vif(logit2) age sexTRUE 1.047368 1.010986 chronic_disease_binaryTRUE country_altJapan 1.090713 1.057938 country_altMalaysia country_altNepal 1.085748 1.029110 country_altPhilippines country_altSingapore 3.546896 2.639480 country_altSouth Korea country_altThailand 1.285864 1.028649 country_altVietnam 1.438922 Nemlinearit√°s vizsg√°lata a RESET-teszttel A linearit√°s tesztel√©s√©hez felhaszn√°ltuk a Ramsey-f√©le RESET-tesztet √©s a CR-plotokat. Ezek alapj√°n pedig a jelenlegi modell√ºnk nemline√°ris, amely miatt az √©letkor v√°ltoz√≥t alak√≠tjuk √°t. El≈ësz√∂r az √©letkor √°talak√≠t√°s√°val pr√≥b√°lkoztunk: 1. 35-n√©l megt√∂r≈ë CR-plot miatt annak bev√©tele a modellbe 2. √∂tvenfelett dummy l√©trehoz√°sa Mivel az els≈ë m√≥dszer sikerre vezetett, a m√°sodikat nem pr√≥b√°ltuk meg. #Linearit√°s tesztel√©se megmutatja, hogy m√©g nem line√°ris a modell resettest(logit2, type=&quot;regressor&quot;) RESET test data: logit2 RESET = 22.451, df1 = 6, df2 = 5250, p-value &lt; 2.2e-16 crPlots(logit2) crPlots(logit2, ~age) #Az √©letkor v√°ltoz√≥ nagyj√°b√≥l 35 √©vn√©l t√∂rik meg, ezt kell belevenn√ºnk a modellbe logit3 &lt;- glm(died~age+sex+chronic_disease_binary+country_alt+pmax(age-35,0), data=data_Asia, family=binomial(logit)) summary(logit3) Call: glm(formula = died ~ age + sex + chronic_disease_binary + country_alt + pmax(age - 35, 0), family = binomial(logit), data = data_Asia) Deviance Residuals: Min 1Q Median 3Q Max -2.34145 -0.63063 -0.37089 -0.00011 2.82050 Coefficients: Estimate Std. Error z value Pr(&gt;|z|) (Intercept) -2.58076 0.53148 -4.856 1.20e-06 *** age 0.03218 0.01329 2.421 0.01547 * sexTRUE 0.47988 0.07761 6.183 6.28e-10 *** chronic_disease_binaryTRUE 2.13050 0.32237 6.609 3.88e-11 *** country_altJapan -16.72685 1967.29686 -0.009 0.99322 country_altMalaysia -17.54875 1417.57052 -0.012 0.99012 country_altNepal -16.49485 2797.44196 -0.006 0.99530 country_altPhilippines -1.37796 0.33313 -4.136 3.53e-05 *** country_altSingapore -17.36252 335.74122 -0.052 0.95876 country_altSouth Korea -16.67985 837.13291 -0.020 0.98410 country_altThailand -17.81103 2797.44196 -0.006 0.99492 country_altVietnam -18.97497 575.60639 -0.033 0.97370 pmax(age - 35, 0) 0.04405 0.01491 2.955 0.00313 ** --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 (Dispersion parameter for binomial family taken to be 1) Null deviance: 5835.2 on 5267 degrees of freedom Residual deviance: 4340.9 on 5255 degrees of freedom AIC: 4366.9 Number of Fisher Scoring iterations: 16 resettest(logit3, type=&quot;regressor&quot;) RESET test data: logit3 RESET = 0.44526, df1 = 8, df2 = 5247, p-value = 0.8943 crPlots(logit3) linearHypothesis(logit3, c(&quot;country_altJapan=0&quot;, &quot;country_altMalaysia=0&quot;, &quot;country_altNepal=0&quot;, &quot;country_altVietnam=0&quot;, &quot;country_altSingapore=0&quot;, &quot;country_altSouth Korea=0&quot;, &quot;country_altThailand=0&quot;)) Linear hypothesis test Hypothesis: country_altJapan = 0 country_altMalaysia = 0 country_altNepal = 0 country_altVietnam = 0 country_altSingapore = 0 country_altSouth Korea = 0 country_altThailand = 0 Model 1: restricted model Model 2: died ~ age + sex + chronic_disease_binary + country_alt + pmax(age - 35, 0) Res.Df Df Chisq Pr(&gt;Chisq) 1 5262 2 5255 7 0.0045 1 data_Asia$fulopindia &lt;- as.logical(data_Asia$country_alt==&quot;Philippines&quot;) Ezut√°n a nem szignifik√°ns v√°ltoz√≥k k√∂z√ºl az orsz√°gokat l√°tjuk csak, √≠gy ezek √∂sszevont elhagy√°s√°t tesztelj√ºk, a F√ºl√∂p-szk. √©s Indi√°t kiv√©ve. Mivel a tesztn√©l p&gt;0,05, √≠gy ezeket a v√°ltoz√≥t kidobhatjuk, az √∫j dummyval pedig elk√©sz√ºlt a modell√ºnk. Az √∫j modellben viszont az √©letkor v√°ltoz√≥ √°talak√≠tott form√°j√°ban magas VIF-et okoz, √≠gy az eredeti √©letkort - amely a kev√©sb√© szignifik√°ns v√°ltoz√≥ - kihagyjuk a modellb≈ël. logit4 &lt;- glm(died~age+sex+chronic_disease_binary+fulopindia+I(pmax(age-35,0)), data=data_Asia, family=binomial(logit)) summary(logit4) Call: glm(formula = died ~ age + sex + chronic_disease_binary + fulopindia + I(pmax(age - 35, 0)), family = binomial(logit), data = data_Asia) Deviance Residuals: Min 1Q Median 3Q Max -2.3283 -0.6371 -0.3751 -0.2097 2.8072 Coefficients: Estimate Std. Error z value Pr(&gt;|z|) (Intercept) -4.56944 0.47649 -9.590 &lt; 2e-16 *** age 0.03081 0.01328 2.319 0.02039 * sexTRUE 0.46982 0.07694 6.107 1.02e-09 *** chronic_disease_binaryTRUE 2.09148 0.29034 7.203 5.87e-13 *** fulopindiaTRUE 0.64892 0.21725 2.987 0.00282 ** I(pmax(age - 35, 0)) 0.04610 0.01490 3.095 0.00197 ** --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 (Dispersion parameter for binomial family taken to be 1) Null deviance: 5835.2 on 5267 degrees of freedom Residual deviance: 4428.9 on 5262 degrees of freedom AIC: 4440.9 Number of Fisher Scoring iterations: 5 resettest(logit4, type=&quot;regressor&quot;) RESET test data: logit4 RESET = 0.41565, df1 = 10, df2 = 5252, p-value = 0.9399 vif(logit4) age sexTRUE 13.751477 1.008184 chronic_disease_binaryTRUE fulopindiaTRUE 1.057303 1.020537 I(pmax(age - 35, 0)) 13.803814 linearHypothesis(logit4, &quot;age&quot;) Linear hypothesis test Hypothesis: age = 0 Model 1: restricted model Model 2: died ~ age + sex + chronic_disease_binary + fulopindia + I(pmax(age - 35, 0)) Res.Df Df Chisq Pr(&gt;Chisq) 1 5263 2 5262 1 5.3783 0.02039 * --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 logit_final &lt;- glm(died~sex+chronic_disease_binary+fulopindia+I(pmax(age-35,0)), data=data_Asia, family=binomial(logit)) summary(logit_final) Call: glm(formula = died ~ sex + chronic_disease_binary + fulopindia + I(pmax(age - 35, 0)), family = binomial(logit), data = data_Asia) Deviance Residuals: Min 1Q Median 3Q Max -2.3423 -0.6262 -0.4012 -0.2523 2.4918 Coefficients: Estimate Std. Error z value Pr(&gt;|z|) (Intercept) -3.614952 0.227491 -15.891 &lt; 2e-16 *** sexTRUE 0.475936 0.077004 6.181 6.38e-10 *** chronic_disease_binaryTRUE 2.097687 0.291009 7.208 5.66e-13 *** fulopindiaTRUE 0.659963 0.217446 3.035 0.0024 ** I(pmax(age - 35, 0)) 0.080474 0.002715 29.641 &lt; 2e-16 *** --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 (Dispersion parameter for binomial family taken to be 1) Null deviance: 5835.2 on 5267 degrees of freedom Residual deviance: 4435.0 on 5263 degrees of freedom AIC: 4445 Number of Fisher Scoring iterations: 5 vif(logit_final) sexTRUE chronic_disease_binaryTRUE 1.007962 1.056893 fulopindiaTRUE I(pmax(age - 35, 0)) 1.017931 1.044902 resettest(logit_final, type=&quot;regressor&quot;) RESET test data: logit_final RESET = 0.31875, df1 = 8, df2 = 5255, p-value = 0.9593 #Az egy√ºtthat√≥k jelent√©se exp(coef(logit_final)) (Intercept) sexTRUE 0.02691822 1.60952006 chronic_disease_binaryTRUE fulopindiaTRUE 8.14730002 1.93472091 I(pmax(age - 35, 0)) 1.08380014 plotmo(logit_final) plotmo grid: sex chronic_disease_binary fulopindia age TRUE FALSE TRUE 46 Az √°talak√≠tott modell√ºnk megfelel minden feltev√©snek √©s tesztnek, √≠gy ennek egy√ºtthat√≥it √©rtelmezhetj√ºk: -cet. par. a f√©rfi l√©t 1,61-szeres√©re n√∂veli a hal√°loz√°s odds√°nak √©rt√©k√©t -cet. par. a kr√≥nikus betegs√©g megl√©te 8,15-szeres√©re n√∂veli a hal√°loz√°s odds√°nak √©rt√©k√©t -cet. par. a F√ºl√∂p-szk-n vagy Indi√°ban val√≥ √°llampolg√°rs√°g 1,95-szeres√©re n√∂veli a hal√°loz√°s odds√°nak √©rt√©k√©t -cet. par. a 35 √©vn√©l id≈ësebb embereknek 1,08-szor nagyobb a hal√°loz√°s odds√°nak √©rt√©ke El≈ërejelz√©s a kiv√°lasztott modellel deathval &lt;- predict(logit_final, data_Asia, type=&quot;response&quot;) data_Asia$deathval &lt;- deathval data_Asia$becsult &lt;- ifelse(deathval&gt;0.5, &quot;TRUE&quot;, &quot;FALSE&quot;) xtabs(~died+becsult, data=data_Asia) becsult died FALSE TRUE FALSE 3674 317 TRUE 766 511 fin_perc &lt;- sum(data_Asia$died==data_Asia$becsult)/nrow(data_Asia)*100 A pr√≥ba 50%-os cutoff √©rt√©kn√©l a modell 79.4419134%-ban helyes eredm√©nyt ad. Az ROC-g√∂rbe GINI-mutat√≥ja 0.6554136. A modell√ºnk kalibr√°l√°sa sor√°n a m√°sodfaj√∫ hiba s√∫lya 3, √≠gy a sim√≠tott k√∂lts√©gf√ºggv√©ny alapj√°n a 0.2960607 lesz az optim√°lis k√ºsz√∂b√©rt√©k. becsult_final died FALSE TRUE FALSE 3197 794 TRUE 405 872 Az optim√°lis k√ºsz√∂b√©rt√©kn√©l a klasszifik√°ci√≥ pontoss√°ga 77.2399393% lesz. "],
["Chapter-4.html", "Sz√∂vegelemz√©s Elemz√©s", " Sz√∂vegelemz√©s p { text-align: justify; } Elemz√©s A koronav√≠rus esem√©nyei √©s a vele kapcsolatos h√≠rek megmutatj√°k, hogy az emberek √©s a k√ºl√∂nb√∂z≈ë m√©diumok hogyan viszonyulnak a pand√©mi√°hoz az id≈ë eltelt√©vel. Ezen elemz√©shez a Guardian napilap COVID-19-el kapcsolatos c√≠meit gy≈±jt√∂tt√ºk √∂ssze. A k√∂r√ºlbel√ºl egy √©v szalagc√≠meit fel√∂lel≈ë korpuszon bag of Words m√≥dszerrel a havonta √©s az egy √©v sor√°n leggyakoribb szavakat kerest√ºk meg, sentiment anal√≠zissel pedig az AFINN sz√≥t√°r √©rzelmi sk√°l√°ja seg√≠ts√©g√©vel elemezt√ºk a napi h√≠rek korpuszait. nr_of_pages=528 #528 lapig lehetett visszamenni a keres√©sben for (i in 1:nr_of_pages) { URL &lt;- paste(&quot;https://www.theguardian.com/world/coronavirus-outbreak+uk/uk?page=&quot;, i, sep = &quot;&quot;) page &lt;- read_html(URL) title &lt;- html_text(html_nodes(page, &quot;.js-headline-text&quot;)) #Van olyan hogy egy lapon k√©t d√°tum is szerepel, heti bont√°s miatt ez nem probl√©ma time &lt;- html_text(html_nodes(page, &quot;.fc-date-headline&quot;))[1] if (i==1){ data_raw &lt;- data.frame(time, title) } else{ data_raw &lt;- rbind(data_raw, data.frame(time, title)) } } A Guardian honlapj√°n a COVID keres≈ësz√≥ra nagyj√°b√≥l janu√°r 29-t≈ël kezd≈ëd≈ëen nagyj√°b√≥l 1.05610^{4} cikk c√≠met tal√°ltunk data_cleansed &lt;- data_raw %&gt;% filter(!duplicated(title)) %&gt;% {mutate(., id = seq(nrow(.)))} %&gt;% mutate( date = as.Date(time, format = &quot;%d %B %Y&quot;), month = format(date, &quot;%Y-%m&quot;) ) %&gt;% na.omit() Bag of Words corpus_raw &lt;- Corpus(VectorSource(as.character(data_cleansed$title))) #Korpusz tiszt√≠t√°sa corpus_filtered &lt;- corpus_raw %&gt;% tm_map(content_transformer(tolower)) %&gt;% tm_map(stripWhitespace) %&gt;% tm_map(removeNumbers) %&gt;% tm_map(removePunctuation, ucp=TRUE) %&gt;% tm_map(removeWords, c(stopwords(&quot;english&quot;), &quot;also&quot;, &quot;one&quot;, &quot;will&quot;)) A korpusz szok√°sos tiszt√≠t√°sa k√∂zben voltak olyan stopwordok, amelyeket mi adtunk hozz√°, majd a struktur√°lt m√°trix √©s a fogalmak eloszl√°s√°t vizsg√°ltuk a teljes korpuszban termdocument &lt;- removeSparseTerms(TermDocumentMatrix(corpus_filtered), 0.999) documentterm &lt;- removeSparseTerms(DocumentTermMatrix(corpus_filtered), 0.999) words_frequency_all &lt;- data.frame(Words=row.names(as.matrix(termdocument)), Freq=rowSums(as.matrix(termdocument), na.rm = TRUE)) freqterms &lt;- findFreqTerms(documentterm, lowfreq = 100) ggwordcloud(words_frequency_all$Words, words_frequency_all$Freq, max.words = 100) A havonta leggyakoribb szavakat vizsg√°ltuk egy ciklusban, amely a havi korpuszokat megtiszt√≠tja √©s elemzi data_cleansed_monthly &lt;- data_cleansed %&gt;% group_by(month) %&gt;% summarise(monthly_text = paste(title, collapse = &quot; &quot;)) #T√°bl√°zat l√©trehoz√°sa words_monthly &lt;- data.frame(matrix(ncol=nrow(data_cleansed_monthly), nrow=15)) colnames(words_monthly) &lt;- data_cleansed_monthly$month for (i in 1:nrow(data_cleansed_monthly)){ #Corpus l√©trehoz√°sa corpus_monthly_raw &lt;- Corpus(VectorSource(as.character(data_cleansed_monthly$monthly_text[i]))) #Korpusz tiszt√≠t√°sa corpus_monthly_filtered &lt;- corpus_monthly_raw %&gt;% tm_map(content_transformer(tolower)) %&gt;% tm_map(removePunctuation, ucp=TRUE) %&gt;% tm_map(removeNumbers) %&gt;% tm_map(removeWords, c(stopwords(&quot;english&quot;), &quot;also&quot;, &quot;one&quot;, &quot;will&quot;)) #%&gt;% tm_map(stemDocument) #Term-Document m√°trix l√©trehoz√°sa a 10 leggyakoribb sz√≥ miatt matrix_monthly &lt;- removeSparseTerms(TermDocumentMatrix(corpus_monthly_filtered), 0.999) words_frequency &lt;- data.frame(Words = matrix_monthly$dimnames$Terms, Freq = matrix_monthly$v) words_monthly[,data_cleansed_monthly$month[i]]&lt;- head(words_frequency[order(-words_frequency$Freq),]$Words,15) #Sz√≥felh≈ëk k√©sz√≠t√©se, a corpus nagys√°g√°t√≥l f√ºgg≈ëen plot(ggwordcloud(words_frequency$Words, words_frequency$Freq, max.words = 100)+ ggtitle(data_cleansed_monthly$month[i])) #wordcloud(corpus_monthly_filtered, max.words=0.1*matrix_monthly$nrow) } A havonta 15 leggyakoribb sz√≥ a Guardian c√≠meiben. Sz√≠nekkel a teljes korpusz leggyakoribb szavait jel√∂lt√ºk A t√°bl√°zatb√≥l az al√°bbi inform√°ci√≥k olvashat√≥ak le: -a janu√°r-febru√°ri id≈ëszakban az Egyes√ºlt Kir√°lys√°ggal m√©g kev√©sb√© foglalkoztak a cikkek -a k√∂vetkez≈ë id≈ëszakban Nagy-Britannia minisztereln√∂ke √©s az ott bevezetett tier alap√∫ m√≥dszer k√ºlcsszavai is el≈ëker√ºltek -a kar√°csonyi lez√°r√°sok m√°r novemberben is k√∂zbesz√©d alapja voltak -a kezdeti ‚Äòcoronavirus‚Äô kifejez√©sr≈ël fokozatosan √°llt √°t a Guardian az egyszer≈±bb, COVID bet≈±sz√≥ra Sentiment elemz√©s A sentiment elemz√©sben a napi c√≠mekb≈ël, az AFINN sz√≥t√°r √©rzelmi sk√°l√°j√°nak felhaszn√°l√°s√°val k√©sz√ºlt A grafikonokon pedig az √©rzelmet tartalmaz√≥ szavak sz√°m√°t √©s a napi √°tlagokat √°br√°zoltuk #AFINN lexikon bet√∂lt√©se AFINN &lt;- get_sentiments(&quot;afinn&quot;) data_cleansed &lt;- data_cleansed %&gt;% mutate( title = as.character(title) ) #Szavakra bont√°s, pontsz√°mok √∂sszeaggreg√°l√°sa words &lt;- left_join( tidytext::unnest_tokens(data_cleansed, words, title), AFINN, by=c(&quot;words&quot;=&quot;word&quot;)) nr_sentiment_words &lt;- words %&gt;% group_by(date) %&gt;% summarise(non_na_count = sum(!is.na(value))) score_by_id &lt;- words %&gt;% group_by(id) %&gt;% summarize(score=sum(value, na.rm=TRUE)) #Eredeti adatok mell√© rak√°s data_cleansed &lt;- left_join(data_cleansed, score_by_id, by=&quot;id&quot;) #Napi (√©s heti) aggreg√°l√°s score_by_day &lt;- data_cleansed %&gt;% group_by(date) %&gt;% summarize(score_sum=sum(score, na.rm=TRUE), score_avg=mean(score, na.rm=TRUE)) Grafikonok deaths_in_uk &lt;- read_csv(&quot;data_2020-Dec-29.csv&quot;, col_types = cols_only(date = col_guess(), newDeaths28DaysByDeathDate = col_guess())) nr_sentiment_words &lt;- merge(nr_sentiment_words, deaths_in_uk, by=&quot;date&quot;) coeff=10 ggplot(nr_sentiment_words, aes(x=date)) + geom_line(aes(y=non_na_count), size=.5, color=&quot;#0fad04&quot;)+ geom_bar(aes(y = newDeaths28DaysByDeathDate/coeff), stat=&quot;identity&quot;, size=.1, fill=&quot;steelblue&quot;, alpha=.4) + geom_smooth(aes(y=non_na_count), method=&quot;loess&quot;, colour=&quot;#0fad04&quot;, alpha=0.2) + geom_hline(yintercept=0, color=&quot;black&quot;, size=.75) + xlab(&quot;D√°tum&quot;) + scale_x_date(date_breaks = &quot;1 month&quot;, date_labels = &quot;%Y %m&quot;) + scale_y_continuous( name = &quot;√ârzelmi szavak sz√°ma naponta&quot;, sec.axis = sec_axis(~.*coeff, name=&quot;Napi hal√°loz√°sok sz√°ma&quot;) ) ggplot(score_by_day, aes(x=date)) + geom_line( aes(y=score_avg), color=&quot;#0fad04&quot;) + geom_smooth(aes(y=score_avg), method=&quot;loess&quot;, colour=&quot;#0fad04&quot;, alpha=0.2) + geom_hline(yintercept=0, color=&quot;black&quot;, size=.75) + xlab(&quot;D√°tum&quot;) + ylab(&quot;√Åtlagos napi √©rzelmi pontsz√°m&quot;) + scale_x_date(date_breaks = &quot;1 month&quot;, date_labels = &quot;%Y %m&quot;) + ylim(-2.5, 2.5) A grafikonokr√≥l el lehet mondani, hogy az √©rzelemmel t√∂lt√∂tt szavak sz√°ma √°prilisban tet≈ëz√∂tt. A brit korm√°ny ekkor kezdte el bevezetni a szigor√∫bb int√©zked√©seit, Eur√≥p√°ban az egyik legutols√≥k√©nt, a halottak sz√°ma pedig . Ez a t√©ny pedig az er≈ësen liber√°lis Guardian lapn√°l val√≥sz√≠n≈±leg er≈ës √©rzelmeket v√°lthatott ki. Az √°tlagos √©rzelmi t√∂ltet ugyanakkor viszonylag stabilan n√∂vekedik, amely a vakcina megjelen√©s√©nek √©s az emberek v√≠rushoz val√≥ hozz√°szok√°s√°nak lehet k√∂sz√∂nhet≈ë. "],
["Chapter-5.html", "Id≈ësor elemz√©s SARIMA", " Id≈ësor elemz√©s p { text-align: justify; } A k√∂vetkez≈ëkben sztochasztikus id≈ësorelemz√©si elj√°r√°ssal modellezz√ºk a magyar COVID-19 megbeteged√©s sz√°mot. Az adatok az Our World in Data4 weboldalr√≥l sz√°rmaznak, napi √∫j regisztr√°l√°sokat √©s hal√°leseteket tartalmaznak. dat &lt;- readxl::read_excel(&#39;COVID-19-geographic-disbtribution-worldwide.xlsx&#39;) dat %&gt;% head %&gt;% gt %&gt;% tab_header(title = &#39;A let√∂lt√∂tt adatt√°bla&#39;) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #reajxggcyr .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #reajxggcyr .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #reajxggcyr .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #reajxggcyr .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #reajxggcyr .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #reajxggcyr .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #reajxggcyr .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #reajxggcyr .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #reajxggcyr .gt_column_spanner_outer:first-child { padding-left: 0; } #reajxggcyr .gt_column_spanner_outer:last-child { padding-right: 0; } #reajxggcyr .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #reajxggcyr .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #reajxggcyr .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #reajxggcyr .gt_from_md > :first-child { margin-top: 0; } #reajxggcyr .gt_from_md > :last-child { margin-bottom: 0; } #reajxggcyr .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #reajxggcyr .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #reajxggcyr .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #reajxggcyr .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #reajxggcyr .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #reajxggcyr .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #reajxggcyr .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #reajxggcyr .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #reajxggcyr .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #reajxggcyr .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #reajxggcyr .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #reajxggcyr .gt_sourcenote { font-size: 90%; padding: 4px; } #reajxggcyr .gt_left { text-align: left; } #reajxggcyr .gt_center { text-align: center; } #reajxggcyr .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #reajxggcyr .gt_font_normal { font-weight: normal; } #reajxggcyr .gt_font_bold { font-weight: bold; } #reajxggcyr .gt_font_italic { font-style: italic; } #reajxggcyr .gt_super { font-size: 65%; } #reajxggcyr .gt_footnote_marks { font-style: italic; font-size: 65%; } A let√∂lt√∂tt adatt√°bla dateRep day month year cases deaths countriesAndTerritories geoId countryterritoryCode popData2019 continentExp Cumulative_number_for_14_days_of_COVID-19_cases_per_100000 2020-12-14 14 12 2020 746 6 Afghanistan AF AFG 38041757 Asia 9.013779 2020-12-13 13 12 2020 298 9 Afghanistan AF AFG 38041757 Asia 7.052776 2020-12-12 12 12 2020 113 11 Afghanistan AF AFG 38041757 Asia 6.868768 2020-12-11 11 12 2020 63 10 Afghanistan AF AFG 38041757 Asia 7.134266 2020-12-10 10 12 2020 202 16 Afghanistan AF AFG 38041757 Asia 6.968658 2020-12-09 9 12 2020 135 13 Afghanistan AF AFG 38041757 Asia 6.963401 dat %&gt;% filter(countryterritoryCode == &#39;HUN&#39;) %&gt;% arrange(dateRep) %&gt;% ggplot + geom_line(aes(dateRep, cases)) + labs(x = NULL, y = &#39;√öj megfert≈ëzd√©sek&#39;, title = &quot;Megfert≈ëz≈ëd√©sek sz√°m√°nak alakul√°sa Magyarorsz√°gon&quot;) √ârdemes strut√∫r√°lis t√∂r√©snek tekinteni 2020 szeptember√©t, innt≈ël jelent≈ësen emelkednek az esetsz√°mok. Mivel l√°tszik, hogy nem stacioner a napi √∫j esetek sz√°ma, √≠gy annak transzform√°ci√≥it is √©rdemes megvizsg√°lni (diff, log). dat %&gt;% filter(countryterritoryCode == &#39;HUN&#39;, dateRep &gt; lubridate::ymd(&#39;2020-09-01&#39;)) %&gt;% arrange(dateRep) %&gt;% select(dateRep, cases) %&gt;% mutate( diff = c(NA, diff(cases)), log = log(cases) ) %T&gt;% {print(apply(select(., diff, log), 2, function(x) forecast::ndiffs(na.omit(x)) == 0 ))} %&gt;% select(-cases) %&gt;% pivot_longer(-1) %&gt;% ggplot + geom_line(aes(dateRep, value)) + facet_wrap(~name, ncol = 1, scales = &#39;free_y&#39;) + labs(title = &#39;A magyar esetsz√°mok id≈ësor√°nak transzform√°ci√≥i&#39;, x = NULL, y = NULL) diff log TRUE FALSE Mivel az esetsz√°mok differenci√°zottja stacioner, √≠gy azon folytatjuk a Box-jenkins modellez√©st. dat %&gt;% filter(countryterritoryCode == &#39;HUN&#39;, dateRep &gt; lubridate::ymd(&#39;2020-09-01&#39;)) %&gt;% arrange(dateRep) %&gt;% pull(cases) %&gt;% ts %&gt;% forecast::auto.arima() %T&gt;% {tab_header(gt(broom::tidy(.)), &#39;ARIMA(0,1,2) modell&#39;)} %&gt;% forecast::checkresiduals() Ljung-Box test data: Residuals from ARIMA(0,1,2) with drift Q* = 17.63, df = 7, p-value = 0.01376 Model df: 3. Total lags used: 10 A Ljung-Box teszt alapj√°n elutas√≠tjuk a nullhipot√©zist, miszerint a marad√©ktag feh√©rzaj folyamat lenne. A marad√©ktagot ACF-j√©b≈ël l√°tjuk, hogy a 7. k√©sleltet√©s az, amely statisztikailag szignifik√°ns √©s ez elm√©leti megfontol√°sb√≥l is meg√°llja a hely√©t (H√©tv√©g√©n kevesebbet mennek el az emberek teszetlni, mert ink√°bb otthon maradnak megpr√≥b√°lni kipihenni). dat %&gt;% filter(countryterritoryCode == &#39;HUN&#39;, dateRep &gt;= lubridate::ymd(&#39;2020-09-01&#39;)) %&gt;% arrange(dateRep) %&gt;% pull(cases) %&gt;% ts(frequency = 7) %&gt;% forecast::ggmonthplot() + labs(x = NULL, y = &#39;Napi esetsz√°m&#39;, title = &#39;Esetsz√°mok h√©t napjai szerint lebontva&#39;) dat %&gt;% filter(countryterritoryCode == &#39;HUN&#39;, dateRep &gt;= lubridate::ymd(&#39;2020-09-01&#39;)) %&gt;% arrange(dateRep) %&gt;% mutate(day = weekdays(dateRep)) %&gt;% lm(formula = cases ~ day) %&gt;% .$resid %&gt;% ts %&gt;% forecast::auto.arima() %&gt;% {mod &lt;&lt;- .} broom::tidy(mod) %&gt;% gt %&gt;% tab_header(&#39;Heti szezonalit√°ssal sz≈±rt ARIMA(0,1,2) modell param√©terei&#39;) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #lzxqipkygr .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #lzxqipkygr .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #lzxqipkygr .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #lzxqipkygr .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #lzxqipkygr .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #lzxqipkygr .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #lzxqipkygr .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #lzxqipkygr .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #lzxqipkygr .gt_column_spanner_outer:first-child { padding-left: 0; } #lzxqipkygr .gt_column_spanner_outer:last-child { padding-right: 0; } #lzxqipkygr .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #lzxqipkygr .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #lzxqipkygr .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #lzxqipkygr .gt_from_md > :first-child { margin-top: 0; } #lzxqipkygr .gt_from_md > :last-child { margin-bottom: 0; } #lzxqipkygr .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #lzxqipkygr .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #lzxqipkygr .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #lzxqipkygr .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #lzxqipkygr .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #lzxqipkygr .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #lzxqipkygr .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #lzxqipkygr .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #lzxqipkygr .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #lzxqipkygr .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #lzxqipkygr .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #lzxqipkygr .gt_sourcenote { font-size: 90%; padding: 4px; } #lzxqipkygr .gt_left { text-align: left; } #lzxqipkygr .gt_center { text-align: center; } #lzxqipkygr .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #lzxqipkygr .gt_font_normal { font-weight: normal; } #lzxqipkygr .gt_font_bold { font-weight: bold; } #lzxqipkygr .gt_font_italic { font-style: italic; } #lzxqipkygr .gt_super { font-size: 65%; } #lzxqipkygr .gt_footnote_marks { font-style: italic; font-size: 65%; } Heti szezonalit√°ssal sz≈±rt ARIMA(0,1,2) modell param√©terei term estimate std.error ma1 -0.2319610 0.09318890 ma2 -0.4137085 0.09259579 drift 38.5799908 23.28876815 mod %&gt;% forecast::checkresiduals() Ljung-Box test data: Residuals from ARIMA(0,1,2) with drift Q* = 11.929, df = 7, p-value = 0.1029 Model df: 3. Total lags used: 10 SARIMA dat %&gt;% filter(countryterritoryCode == &#39;HUN&#39;, dateRep &gt;= lubridate::ymd(&#39;2020-09-01&#39;)) %&gt;% arrange(dateRep) %&gt;% pull(cases) %&gt;% ts(frequency = 7) %&gt;% forecast::auto.arima() %T&gt;% {m.sarima &lt;&lt;- .} %&gt;% forecast::checkresiduals() Ljung-Box test data: Residuals from ARIMA(0,1,2)(0,0,2)[7] Q* = 9.397, df = 10, p-value = 0.4949 Model df: 4. Total lags used: 14 Szezon√°lis ARIMA modellt alkalmazva l√©nyegesen nagyobb p-√©rt√©ket kaptunk a modell hibatagjain elv√©gzett Ljung-box teszthet. m.sarima %&gt;% broom::tidy() %&gt;% gt %&gt;% tab_header(title = &#39;Illesztett SARIMA modell param√©terei&#39;) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #mdihotbvqy .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #mdihotbvqy .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #mdihotbvqy .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #mdihotbvqy .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #mdihotbvqy .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #mdihotbvqy .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #mdihotbvqy .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #mdihotbvqy .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #mdihotbvqy .gt_column_spanner_outer:first-child { padding-left: 0; } #mdihotbvqy .gt_column_spanner_outer:last-child { padding-right: 0; } #mdihotbvqy .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #mdihotbvqy .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #mdihotbvqy .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #mdihotbvqy .gt_from_md > :first-child { margin-top: 0; } #mdihotbvqy .gt_from_md > :last-child { margin-bottom: 0; } #mdihotbvqy .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #mdihotbvqy .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #mdihotbvqy .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #mdihotbvqy .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #mdihotbvqy .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #mdihotbvqy .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #mdihotbvqy .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #mdihotbvqy .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #mdihotbvqy .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #mdihotbvqy .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #mdihotbvqy .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #mdihotbvqy .gt_sourcenote { font-size: 90%; padding: 4px; } #mdihotbvqy .gt_left { text-align: left; } #mdihotbvqy .gt_center { text-align: center; } #mdihotbvqy .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #mdihotbvqy .gt_font_normal { font-weight: normal; } #mdihotbvqy .gt_font_bold { font-weight: bold; } #mdihotbvqy .gt_font_italic { font-style: italic; } #mdihotbvqy .gt_super { font-size: 65%; } #mdihotbvqy .gt_footnote_marks { font-style: italic; font-size: 65%; } Illesztett SARIMA modell param√©terei term estimate std.error ma1 -0.2611314 0.09140709 ma2 -0.3684478 0.09375723 sma1 0.4138886 0.10226211 sma2 0.2088278 0.10980747 ggpubr::ggarrange( forecast::forecast(mod) %&gt;% forecast::autoplot(showgap = F), forecast::forecast(m.sarima) %&gt;% forecast::autoplot(showgap = F), nrow = 2 ) https://ourworldindata.org/coronavirus-source-data‚Ü©Ô∏é "],
["Chapter-6.html", "F≈ëkomponens elemz√©s Adatok forr√°sa", " F≈ëkomponens elemz√©s Adatok forr√°sa F≈ëbb koronav√≠rusos adatok keresztmetszeti t√°bl√°j√°t 187 orsz√°gra az al√°bbi weboldalr√≥l t√∂lt√∂tt√ºnk le: https://www.kaggle.com/imdevskp/corona-virus-report?select=country_wise_latest.csv p { text-align: justify; } d.covid &lt;- vroom::vroom(&#39;country_wise_latest.csv&#39;) d.covid %&gt;% head %&gt;% gt %&gt;% tab_header(&#39;Let√∂lt√∂tt adatt√°bla COVID-19 adatokr√≥l&#39;) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #mnjfscrcsi .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #mnjfscrcsi .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #mnjfscrcsi .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #mnjfscrcsi .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #mnjfscrcsi .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #mnjfscrcsi .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #mnjfscrcsi .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #mnjfscrcsi .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #mnjfscrcsi .gt_column_spanner_outer:first-child { padding-left: 0; } #mnjfscrcsi .gt_column_spanner_outer:last-child { padding-right: 0; } #mnjfscrcsi .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #mnjfscrcsi .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #mnjfscrcsi .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #mnjfscrcsi .gt_from_md > :first-child { margin-top: 0; } #mnjfscrcsi .gt_from_md > :last-child { margin-bottom: 0; } #mnjfscrcsi .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #mnjfscrcsi .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #mnjfscrcsi .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #mnjfscrcsi .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #mnjfscrcsi .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #mnjfscrcsi .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #mnjfscrcsi .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #mnjfscrcsi .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #mnjfscrcsi .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #mnjfscrcsi .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #mnjfscrcsi .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #mnjfscrcsi .gt_sourcenote { font-size: 90%; padding: 4px; } #mnjfscrcsi .gt_left { text-align: left; } #mnjfscrcsi .gt_center { text-align: center; } #mnjfscrcsi .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #mnjfscrcsi .gt_font_normal { font-weight: normal; } #mnjfscrcsi .gt_font_bold { font-weight: bold; } #mnjfscrcsi .gt_font_italic { font-style: italic; } #mnjfscrcsi .gt_super { font-size: 65%; } #mnjfscrcsi .gt_footnote_marks { font-style: italic; font-size: 65%; } Let√∂lt√∂tt adatt√°bla COVID-19 adatokr√≥l Country/Region Confirmed Deaths Recovered Active New cases New deaths New recovered Deaths / 100 Cases Recovered / 100 Cases Deaths / 100 Recovered Confirmed last week 1 week change 1 week % increase WHO Region Afghanistan 36263 1269 25198 9796 106 10 18 3.50 69.49 5.04 35526 737 2.07 Eastern Mediterranean Albania 4880 144 2745 1991 117 6 63 2.95 56.25 5.25 4171 709 17.00 Europe Algeria 27973 1163 18837 7973 616 8 749 4.16 67.34 6.17 23691 4282 18.07 Africa Andorra 907 52 803 52 10 0 0 5.73 88.53 6.48 884 23 2.60 Europe Angola 950 41 242 667 18 1 0 4.32 25.47 16.94 749 201 26.84 Africa Antigua and Barbuda 86 3 65 18 4 0 5 3.49 75.58 4.62 76 10 13.16 Americas https://apps.who.int/nha/database/ViewData/Indicators/en d.WHO &lt;- readxl::read_excel(&#39;NHA indicators.xlsx&#39;) %&gt;% select(-3) %&gt;% na.omit %&gt;% pivot_wider(names_from = Indicators, values_from = &#39;2018&#39;) %&gt;% mutate_at(-1, function(x) as.numeric(x)) options(scipen = 999) # avoid scientific notation (d.WHO %&gt;% pivot_longer(-1) %&gt;% ggplot + geom_col(aes(Countries, value)) + facet_wrap(~name, scales = &#39;free_y&#39;, ncol = 1) + theme( axis.text.x = element_blank(), axis.ticks.x = element_blank() ) + labs(y = NULL, title = &#39;WHO adatb√°zis√°b√≥l sz√°rmaz√≥ adatok (2008)&#39;)) %&gt;% plotly::ggplotly() d.WHO &lt;- d.WHO %&gt;% # set usable var names set_names(&#39;Country&#39;, &#39;CHE&#39;, &#39;GDP&#39;, &#39;pop&#39;) https://data.worldbank.org/indicator/SP.POP.DPND.OL d.depedency &lt;- readxl::read_excel(&#39;depedency.xls&#39;) %&gt;% na.omit() %&gt;% select(-2) %&gt;% # country code remove set_names(&#39;Country&#39;, &#39;depedencyr&#39;) (d.depedency %&gt;% arrange(depedencyr) %&gt;% mutate( Country = factor(Country, levels = Country) ) %&gt;% ggplot + geom_col(aes(Country, depedencyr)) + labs(title = &#39;√ñregs√©gi eltartotts√°gi r√°ta (2019)&#39;, y = NULL) + theme( axis.text.x = element_blank(), axis.ticks.x = element_blank() )) %&gt;% plotly::ggplotly() d.location &lt;- map_data(&quot;world&quot;) %&gt;% filter(!duplicated(region)) %&gt;% select(Country = region, long, lat) d.location %&gt;% head %&gt;% gt %&gt;% tab_header(&#39;Orsz√°gok f√∂ldrajzi elhelyezked√©se&#39;) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #lgaevmvaul .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #lgaevmvaul .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #lgaevmvaul .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #lgaevmvaul .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #lgaevmvaul .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #lgaevmvaul .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #lgaevmvaul .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #lgaevmvaul .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #lgaevmvaul .gt_column_spanner_outer:first-child { padding-left: 0; } #lgaevmvaul .gt_column_spanner_outer:last-child { padding-right: 0; } #lgaevmvaul .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #lgaevmvaul .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #lgaevmvaul .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #lgaevmvaul .gt_from_md > :first-child { margin-top: 0; } #lgaevmvaul .gt_from_md > :last-child { margin-bottom: 0; } #lgaevmvaul .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #lgaevmvaul .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #lgaevmvaul .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #lgaevmvaul .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #lgaevmvaul .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #lgaevmvaul .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #lgaevmvaul .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #lgaevmvaul .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #lgaevmvaul .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #lgaevmvaul .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #lgaevmvaul .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #lgaevmvaul .gt_sourcenote { font-size: 90%; padding: 4px; } #lgaevmvaul .gt_left { text-align: left; } #lgaevmvaul .gt_center { text-align: center; } #lgaevmvaul .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #lgaevmvaul .gt_font_normal { font-weight: normal; } #lgaevmvaul .gt_font_bold { font-weight: bold; } #lgaevmvaul .gt_font_italic { font-style: italic; } #lgaevmvaul .gt_super { font-size: 65%; } #lgaevmvaul .gt_footnote_marks { font-style: italic; font-size: 65%; } Orsz√°gok f√∂ldrajzi elhelyezked√©se Country long lat Aruba -69.89912 12.45200 Afghanistan 74.89131 37.23164 Angola 23.96650 -10.87178 Anguilla -63.00122 18.22178 Albania 20.06396 42.54727 Finland 20.61133 60.04068 dat &lt;- d.covid %&gt;% rename(Country = &#39;Country/Region&#39;, deathr = &#39;Deaths / 100 Cases&#39;) %&gt;% select(Country, deathr, Confirmed) %&gt;% merge(d.WHO, all.x = T) %&gt;% merge(d.depedency, all.x = T) %&gt;% merge(d.location, all.x = T) %&gt;% na.omit # lost 46 observation ~ 25% p &lt;- dat %&gt;% select(-1) %&gt;% scale %&gt;% princomp p %&gt;% .$loadings %&gt;% unclass() %&gt;% data.frame() %&gt;% rownames_to_column() %&gt;% pivot_longer(-1) %&gt;% mutate( name = str_c(&#39;# &#39;, str_remove(name, &#39;Comp.&#39;)) ) %&gt;% ggplot + aes(rowname, value, fill = value &lt; 0) + geom_hline(yintercept = 0) + geom_col(color = &#39;black&#39;) + coord_flip() + scale_fill_discrete(guide = F) + scale_y_continuous(labels = scales::percent) + facet_wrap(~name) + labs(x = NULL, y = NULL, title = &#39;F≈ëkomponensek&#39;) p %&gt;% .$sdev %&gt;% {data.frame(Komponens = names(.), Variancia = .^2)} %&gt;% mutate( Komponens = str_c(&#39;# &#39;, str_remove(Komponens, &#39;Comp.&#39;)) ) %&gt;% gt %&gt;% tab_header(&#39;F≈ëkomponensek varianci√°i&#39;) %&gt;% fmt_number( columns = vars(Variancia), use_seps = TRUE, dec_mark = &#39;,&#39; ) # TODO Kaiser html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #rvypyximea .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #rvypyximea .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #rvypyximea .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #rvypyximea .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #rvypyximea .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #rvypyximea .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #rvypyximea .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #rvypyximea .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #rvypyximea .gt_column_spanner_outer:first-child { padding-left: 0; } #rvypyximea .gt_column_spanner_outer:last-child { padding-right: 0; } #rvypyximea .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #rvypyximea .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #rvypyximea .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #rvypyximea .gt_from_md > :first-child { margin-top: 0; } #rvypyximea .gt_from_md > :last-child { margin-bottom: 0; } #rvypyximea .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #rvypyximea .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #rvypyximea .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #rvypyximea .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #rvypyximea .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #rvypyximea .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #rvypyximea .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #rvypyximea .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #rvypyximea .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #rvypyximea .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #rvypyximea .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #rvypyximea .gt_sourcenote { font-size: 90%; padding: 4px; } #rvypyximea .gt_left { text-align: left; } #rvypyximea .gt_center { text-align: center; } #rvypyximea .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #rvypyximea .gt_font_normal { font-weight: normal; } #rvypyximea .gt_font_bold { font-weight: bold; } #rvypyximea .gt_font_italic { font-style: italic; } #rvypyximea .gt_super { font-size: 65%; } #rvypyximea .gt_footnote_marks { font-style: italic; font-size: 65%; } F≈ëkomponensek varianci√°i Komponens Variancia # 1 2,35 # 2 2,18 # 3 1,17 # 4 0,73 # 5 0,58 # 6 0,49 # 7 0,37 # 8 0,07 sapply(1:6, function(i) p %&gt;% .$scores %&gt;% cbind(dat) %&gt;% rename(x = str_c(&#39;Comp.&#39;, i)) %&gt;% arrange(desc(x)) %&gt;% pull(Country) %&gt;% head(5) ) %&gt;% data.frame() %&gt;% {set_names(., str_c(&quot;# &quot;, str_remove(names(.), &quot;X&quot;)))} %&gt;% gt %&gt;% tab_header(&#39;F≈ëkomponenseket legink√°bb jellemz≈ë orsz√°gok&#39;) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #yfzieuuhqk .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #yfzieuuhqk .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #yfzieuuhqk .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #yfzieuuhqk .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #yfzieuuhqk .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #yfzieuuhqk .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #yfzieuuhqk .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #yfzieuuhqk .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #yfzieuuhqk .gt_column_spanner_outer:first-child { padding-left: 0; } #yfzieuuhqk .gt_column_spanner_outer:last-child { padding-right: 0; } #yfzieuuhqk .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #yfzieuuhqk .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #yfzieuuhqk .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #yfzieuuhqk .gt_from_md > :first-child { margin-top: 0; } #yfzieuuhqk .gt_from_md > :last-child { margin-bottom: 0; } #yfzieuuhqk .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #yfzieuuhqk .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #yfzieuuhqk .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #yfzieuuhqk .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #yfzieuuhqk .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #yfzieuuhqk .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #yfzieuuhqk .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #yfzieuuhqk .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #yfzieuuhqk .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #yfzieuuhqk .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #yfzieuuhqk .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #yfzieuuhqk .gt_sourcenote { font-size: 90%; padding: 4px; } #yfzieuuhqk .gt_left { text-align: left; } #yfzieuuhqk .gt_center { text-align: center; } #yfzieuuhqk .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #yfzieuuhqk .gt_font_normal { font-weight: normal; } #yfzieuuhqk .gt_font_bold { font-weight: bold; } #yfzieuuhqk .gt_font_italic { font-style: italic; } #yfzieuuhqk .gt_super { font-size: 65%; } #yfzieuuhqk .gt_footnote_marks { font-style: italic; font-size: 65%; } F≈ëkomponenseket legink√°bb jellemz≈ë orsz√°gok # 1 # 2 # 3 # 4 # 5 # 6 China Norway Brazil China Liberia Hungary France Switzerland Mexico Belize New Zealand Italy Belgium Iceland Chile Mexico China Belgium Italy Denmark Peru Guatemala Argentina Chad Netherlands Belgium Ecuador Chad Uruguay France dat %&gt;% select(-1, -2) %&gt;% kmeans(centers = 5, iter.max = 100, nstart = 100) %&gt;% .$cluster %&gt;% {factoextra::fviz_pca_biplot(p, habillage = .)} # TODO improve "]
]
