[
["index.html", "COVID Mi ez a projekt?", " COVID Granát Marcell &amp; Mazzag Bálint Mi ez a projekt? A tanulmány a Budapesti Corvinus Egyetem Többváltozós adatelemzés tárgy keretében készült. Kézirat lezárásának dátuma: 2021. január 3. A kézirat tartalmához fűzödő tudományos diszkusszió támogatása érdekében egy párbeszéd ablak került megnyitásra az anyagokat tartalmazó GitHub repository oldalán: https://github.com/MarcellGranat/COVID/discussions p { text-align: justify; } .author { font-size: 20px; text-align: center; } .title { text-align: center; } "],
["Chapter-1.html", "Bevezetés", " Bevezetés p { text-align: justify; } Tanulmányomban elemezni kívánom a termékenységi ráta kapcsolatát az egy főre eső bruttó kibocsátással és a munkanélküliségi rátával. A dolgozat főként az idősor- és panelökonometria eszközeire támaszkodom, a választott eszközök: Engel-Granger teszt, vektor autoregresszív modellek, fixhatású longitudinális modell. Elsőként az OECD által közölt termékenységi rátákon végzek kointegrációs vizsgálatot, ahol hipotézisem, hogy egymással szomszédos országok termékenységi arányszámai hasonló pályát járnak be, ami a közös gazdasági- és kulturális környezetből fakad. Ezt követően VAR modellel elemzem a termékenységi ráta, a GDP/fő és munkanélkülisági ráta kapcsolatát. Végül panel modellt készítek az előbb a termékenységi rátára, ahol megyei szintű adatokat használok fel. Ezzel az általam elért szakirodalomban nem találkoztam, és ahogyan az az irodalom feldolgozásomból majd kitűnik, eltérő eszközök eltérő irányú hatást mutatnak ki a jövedelem és a gyermekvállalási hajlandóság között. Ennek megfelelően a hatások irányára előzetes hipotézist nem teszek fel. "],
["Chapter-2.html", "Döntési fa Adatok bemutatása Modellbecslés", " Döntési fa p { text-align: justify; } Az egyik talán legfontosabb kérdés a járványügyben, hogy mennyire halálos a vírus. Már a megjelenésekor nagyon hamar ismertté vált a tény: elsősorban az idősekre és krónikus betegre jelent kockázatot. Ennek a ténynek empirikus teszteléséhez olyan adattáblára van szükségünk, melyben rögzítésre kerülnek a megfertőzöttek demográfiai adatai és az eset végső kimenete (ezt a fajta adattípust nevezik “line list”-nek). Adatok bemutatása Forrás A fentebb leírt célra lett létrehozva egy nyílt projekt1, amely során ezeket az adatokat több országra gyűjtik ki és teszi online elérhetővé. dat &lt;- vroom::vroom(&#39;latestdata.csv&#39;) Az adattábla összesen 2676311 megfigyelést tartalmaz 33 változóval. Azonban a változók jelentős része használhatatlan elemzésre és jelentős mértékben van szükség az adatok tisztítására is. Egyetlen példa említéseként a kimenetben nem egyszerűen died vagy elhunyt szerepelt, hanem annak számos szinonímája is, amelett, hogy sok esetben nincs elérhető adat. set.seed(1) dat %&gt;% count(outcome) %&gt;% na.omit() %&gt;% {mutate(., s = runif(n = nrow(.)))} %&gt;% ggplot(aes(label = outcome, size = s)) + geom_text_wordcloud(color = &#39;aquamarine4&#39;) + labs(title = &quot;Az nyers adattáblában a kimenet változó által felvett értékek&quot;) + theme_minimal() Adatok elemzéshez való előkészítése Az adatok megtiszítása előtt el kell döntenünk, hogy mely változókkal is érdemes foglalkozni, mivel sajnos számos változó esetében hiányzik rengeteg sor a táblában. dat %&gt;% apply(2, function(x) sum(is.na(x))) %&gt;% {data.frame(var = names(.), nobs = nrow(dat)-., robs = (nrow(dat)-.)/nrow(dat))} %&gt;% set_names(&#39;var&#39;, &#39;Hiánytalan adatok száma&#39;, &#39;Hiánytalanok aránya&#39;) %&gt;% gt( rowname_col = &quot;var&quot; ) %&gt;% fmt_percent( columns = vars(&#39;Hiánytalanok aránya&#39;), dec_mark = &#39;,&#39; ) %&gt;% tab_header(title = &#39;Adattáblában lévő hiánytalan megfigyelések aránya&#39;) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #pamufqigws .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #pamufqigws .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #pamufqigws .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #pamufqigws .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #pamufqigws .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #pamufqigws .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #pamufqigws .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #pamufqigws .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #pamufqigws .gt_column_spanner_outer:first-child { padding-left: 0; } #pamufqigws .gt_column_spanner_outer:last-child { padding-right: 0; } #pamufqigws .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #pamufqigws .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #pamufqigws .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #pamufqigws .gt_from_md > :first-child { margin-top: 0; } #pamufqigws .gt_from_md > :last-child { margin-bottom: 0; } #pamufqigws .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #pamufqigws .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #pamufqigws .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #pamufqigws .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #pamufqigws .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #pamufqigws .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #pamufqigws .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #pamufqigws .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #pamufqigws .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #pamufqigws .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #pamufqigws .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #pamufqigws .gt_sourcenote { font-size: 90%; padding: 4px; } #pamufqigws .gt_left { text-align: left; } #pamufqigws .gt_center { text-align: center; } #pamufqigws .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #pamufqigws .gt_font_normal { font-weight: normal; } #pamufqigws .gt_font_bold { font-weight: bold; } #pamufqigws .gt_font_italic { font-style: italic; } #pamufqigws .gt_super { font-size: 65%; } #pamufqigws .gt_footnote_marks { font-style: italic; font-size: 65%; } Adattáblában lévő hiánytalan megfigyelések aránya Hiánytalan adatok száma Hiánytalanok aránya ID 2676311 100,00&percnt; age 578018 21,60&percnt; sex 580157 21,68&percnt; city 1698630 63,47&percnt; province 2223647 83,09&percnt; country 2676196 100,00&percnt; latitude 2676250 100,00&percnt; longitude 2676250 100,00&percnt; geo_resolution 2676250 100,00&percnt; date_onset_symptoms 261599 9,77&percnt; date_admission_hospital 116211 4,34&percnt; date_confirmation 2567822 95,95&percnt; symptoms 0 0,00&percnt; lives_in_Wuhan 0 0,00&percnt; travel_history_dates 2611 0,10&percnt; travel_history_location 9222 0,34&percnt; reported_market_exposure 0 0,00&percnt; additional_information 45855 1,71&percnt; chronic_disease_binary 2676311 100,00&percnt; chronic_disease 0 0,00&percnt; source 2109347 78,82&percnt; sequence_available 0 0,00&percnt; outcome 307382 11,49&percnt; date_death_or_discharge 0 0,00&percnt; notes_for_discussion 0 0,00&percnt; location 13376 0,50&percnt; admin3 80434 3,01&percnt; admin2 826054 30,87&percnt; admin1 1257558 46,99&percnt; country_new 2645758 98,86&percnt; admin_id 2676250 100,00&percnt; data_moderator_initials 1742983 65,13&percnt; travel_history_binary 2610732 97,55&percnt; Az adatok hiányosságának és felhasználhatóságának figyelembevételével az alábbi változókat érdemes bevonni a modellbe: - életkor - nem - ország - van-e krónikus betegsége - fertőződöttség kimutatásának ideje - földrajzi szélesség - földrajzi hosszúság - megbetegedés kimenete A változók tisztítása során egyik legfontosabb, hogy a kimenet oszlopban összevontuk minden elhalálozásra megfelelő szinonímát egységesen az elhunyt kategóriába, és minden felépültnek megfelelőt a felépültbe. Mivel jelen elemzés kutatási kérdése, hogy mi a valószínűsége, hogy valaki túléli, így elvetettünk minden megfigyelést, amely esetében az alany még betegség alatt áll, vagy a kimenet ismeretlen. Az ország oszlopból kontinensként új magyarázó változót határoztunk meg, és az évek esetében ismeretlennek vetük azokat, ahol intervallum került megadásra2. dat %&gt;% select(outcome, age, sex, country, chronic_disease_binary, latitude, longitude, date_confirmation) %&gt;% mutate( continent = countrycode::countrycode(country, origin = &#39;country.name&#39;, destination = &#39;continent&#39;), date = lubridate::dmy(date_confirmation), age = as.numeric(ifelse(str_detect(age, &#39;-&#39;), NA, age)) ) %&gt;% mutate( # cleaning the depedent var outcome = case_when( outcome == &#39;death&#39; ~ &#39;died&#39;, outcome == &#39;died&#39; ~ &#39;died&#39;, outcome == &#39;Death&#39; ~ &#39;died&#39;, outcome == &#39;dead&#39; ~ &#39;died&#39;, outcome == &#39;Dead&#39; ~ &#39;died&#39;, outcome == &#39;Died&#39; ~ &#39;died&#39;, outcome == &#39;Deceased&#39; ~ &#39;died&#39;, outcome == &#39;discharge&#39; ~ &#39;survived&#39;, outcome == &#39;discharged&#39; ~ &#39;survived&#39;, outcome == &#39;Discharged&#39; ~ &#39;survived&#39;, outcome == &#39;Discharged from hospital&#39; ~ &#39;survived&#39;, outcome == &#39;recovered&#39; ~ &#39;survived&#39;, outcome == &#39;released from quarantine&#39; ~ &#39;survived&#39;, outcome == &#39;recovered&#39; ~ &#39;survived&#39;, outcome == &#39;Recovered&#39; ~ &#39;survived&#39;, outcome == &#39;Recovered&#39; ~ &#39;survived&#39;, outcome == &#39;Recovered&#39; ~ &#39;survived&#39;, T ~ &#39;NA&#39; ) ) %&gt;% filter(outcome != &#39;NA&#39;) %&gt;% mutate( died = outcome == &#39;died&#39; ) %&gt;% select(-outcome, -date_confirmation) %&gt;% {dat &lt;&lt;- .} Az így kapott új adattáblában már csupán 103616 megfigyelés és 9 változó szerepel. dat %&gt;% head %&gt;% gt %&gt;% tab_header(title = &#39;Adattábla modellezésre előkészítve&#39;) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #vrzpkjgsbj .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #vrzpkjgsbj .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #vrzpkjgsbj .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #vrzpkjgsbj .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #vrzpkjgsbj .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #vrzpkjgsbj .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #vrzpkjgsbj .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #vrzpkjgsbj .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #vrzpkjgsbj .gt_column_spanner_outer:first-child { padding-left: 0; } #vrzpkjgsbj .gt_column_spanner_outer:last-child { padding-right: 0; } #vrzpkjgsbj .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #vrzpkjgsbj .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #vrzpkjgsbj .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #vrzpkjgsbj .gt_from_md > :first-child { margin-top: 0; } #vrzpkjgsbj .gt_from_md > :last-child { margin-bottom: 0; } #vrzpkjgsbj .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #vrzpkjgsbj .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #vrzpkjgsbj .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #vrzpkjgsbj .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #vrzpkjgsbj .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #vrzpkjgsbj .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #vrzpkjgsbj .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #vrzpkjgsbj .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #vrzpkjgsbj .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #vrzpkjgsbj .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #vrzpkjgsbj .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #vrzpkjgsbj .gt_sourcenote { font-size: 90%; padding: 4px; } #vrzpkjgsbj .gt_left { text-align: left; } #vrzpkjgsbj .gt_center { text-align: center; } #vrzpkjgsbj .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #vrzpkjgsbj .gt_font_normal { font-weight: normal; } #vrzpkjgsbj .gt_font_bold { font-weight: bold; } #vrzpkjgsbj .gt_font_italic { font-style: italic; } #vrzpkjgsbj .gt_super { font-size: 65%; } #vrzpkjgsbj .gt_footnote_marks { font-style: italic; font-size: 65%; } Adattábla modellezésre előkészítve age sex country chronic_disease_binary latitude longitude continent date died 78 male Italy FALSE 45.297748 11.65838 Europe 2020-02-21 TRUE 61 female Singapore FALSE 1.353460 103.81510 Asia 2020-02-14 FALSE 28 male Singapore FALSE 1.353460 103.81510 Asia 2020-02-14 FALSE 56 female Singapore FALSE 1.353460 103.81510 Asia 2020-02-14 FALSE 79 female Singapore FALSE 1.353873 103.86048 Asia 2020-02-14 FALSE 26 male Singapore FALSE 1.353460 103.81510 Asia 2020-02-15 FALSE dat %&gt;% select(age, sex, died) %&gt;% GGally::ggpairs(mapping = aes(color = died), title = &#39;Életkor, nem és az elhalálozás kapcsolata&#39;) dat %&gt;% select(continent, date, died) %&gt;% GGally::ggpairs(aes(color = died), title = &#39;A kontinens a rögzítés dátuma és az elhalálozás kapcsolata&#39;) Az ábrákból sajnos gyorsan kiderül, hogy a kimeneti adatra való rászűrést követően az adattáblában már jórészt csak ázsiai országok képviseltetik magukat. Más kontintensekről származó adatok esetében ez az oszlop nem került megfelelően dokumentálásra. dat %&gt;% group_by(continent, country) %&gt;% summarise(n = n()) %&gt;% ungroup() %&gt;% na.omit() %&gt;% mutate( r = n/nrow(dat) ) %&gt;% arrange(continent) %&gt;% set_names(&#39;continent&#39;, &#39;country&#39;, &#39;n&#39;, &#39;n/sum(n)&#39;) %&gt;% gt( rowname_col = &#39;country&#39;, groupname_col = &#39;continent&#39; ) %&gt;% fmt_percent( columns = &#39;n/sum(n)&#39;, ) %&gt;% summary_rows(groups = T, columns = vars(n), fns = list(TOTAL = &#39;sum&#39;)) %&gt;% summary_rows(groups = T, columns = vars(&#39;n/sum(n)&#39;), fns = list(TOTAL = &#39;sum&#39;), formatter = fmt_percent) %&gt;% tab_options( summary_row.background.color = &quot;#ACEACE&quot;, row_group.background.color = &quot;#FFEFDB&quot; ) %&gt;% tab_header(title = &#39;Megfigyelések száma országonként&#39;, subtitle = &#39;Elsődleges adattisztítás után&#39;) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #akzozxjpul .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #akzozxjpul .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #akzozxjpul .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #akzozxjpul .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #akzozxjpul .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #akzozxjpul .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #akzozxjpul .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #akzozxjpul .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #akzozxjpul .gt_column_spanner_outer:first-child { padding-left: 0; } #akzozxjpul .gt_column_spanner_outer:last-child { padding-right: 0; } #akzozxjpul .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #akzozxjpul .gt_group_heading { padding: 8px; color: #333333; background-color: #FFEFDB; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #akzozxjpul .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFEFDB; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #akzozxjpul .gt_from_md > :first-child { margin-top: 0; } #akzozxjpul .gt_from_md > :last-child { margin-bottom: 0; } #akzozxjpul .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #akzozxjpul .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #akzozxjpul .gt_summary_row { color: #333333; background-color: #ACEACE; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #akzozxjpul .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #akzozxjpul .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #akzozxjpul .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #akzozxjpul .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #akzozxjpul .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #akzozxjpul .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #akzozxjpul .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #akzozxjpul .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #akzozxjpul .gt_sourcenote { font-size: 90%; padding: 4px; } #akzozxjpul .gt_left { text-align: left; } #akzozxjpul .gt_center { text-align: center; } #akzozxjpul .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #akzozxjpul .gt_font_normal { font-weight: normal; } #akzozxjpul .gt_font_bold { font-weight: bold; } #akzozxjpul .gt_font_italic { font-style: italic; } #akzozxjpul .gt_super { font-size: 65%; } #akzozxjpul .gt_footnote_marks { font-style: italic; font-size: 65%; } Megfigyelések száma országonként Elsődleges adattisztítás után n n/sum(n) Africa Algeria 9 0.01&percnt; Burkina Faso 3 0.00&percnt; Cabo Verde 1 0.00&percnt; Cameroon 1 0.00&percnt; Egypt 2 0.00&percnt; Eswatini 1 0.00&percnt; Ethiopia 1 0.00&percnt; Gabon 1 0.00&percnt; Gambia 5 0.00&percnt; Ghana 7 0.01&percnt; Niger 1 0.00&percnt; Nigeria 1 0.00&percnt; Sudan 1 0.00&percnt; Tanzania 1 0.00&percnt; Togo 2 0.00&percnt; Zimbabwe 5 0.00&percnt; TOTAL 42.00 0.04&percnt; Americas Bahamas 1 0.00&percnt; Brazil 4 0.00&percnt; Canada 6 0.01&percnt; Cuba 1 0.00&percnt; Guyana 2 0.00&percnt; United States 48 0.05&percnt; TOTAL 62.00 0.06&percnt; Asia China 105 0.10&percnt; India 98645 95.20&percnt; Iran 4 0.00&percnt; Japan 8 0.01&percnt; Malaysia 6 0.01&percnt; Nepal 2 0.00&percnt; Philippines 4505 4.35&percnt; Singapore 118 0.11&percnt; South Korea 26 0.03&percnt; Thailand 2 0.00&percnt; United Arab Emirates 2 0.00&percnt; Vietnam 32 0.03&percnt; TOTAL 103,455.00 99.84&percnt; Europe France 7 0.01&percnt; Germany 3 0.00&percnt; Italy 7 0.01&percnt; Romania 8 0.01&percnt; San Marino 1 0.00&percnt; Spain 2 0.00&percnt; Switzerland 3 0.00&percnt; TOTAL 31.00 0.03&percnt; Oceania Australia 24 0.02&percnt; TOTAL 24.00 0.02&percnt; A táblázatból jól látható, hogy a legtöbb felhasználható megfigyelésünk Indiából származik. Logikusnak tűnik egy dummy változót létrehozni ezért Indiára (india = {TRUE, ha Indiából származik, FALSE egyébként}). dat %&gt;% mutate( india = country == &#39;India&#39; ) %&gt;% select(-country, -continent, -latitude, -longitude) %&gt;% {dat &lt;&lt;- .} dat %&gt;% head() %&gt;% gt %&gt;% tab_header(title = &#39;Végső adattábla modellezéshez&#39;) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #gxuvhaszck .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #gxuvhaszck .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #gxuvhaszck .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #gxuvhaszck .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #gxuvhaszck .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #gxuvhaszck .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #gxuvhaszck .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #gxuvhaszck .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #gxuvhaszck .gt_column_spanner_outer:first-child { padding-left: 0; } #gxuvhaszck .gt_column_spanner_outer:last-child { padding-right: 0; } #gxuvhaszck .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #gxuvhaszck .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #gxuvhaszck .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #gxuvhaszck .gt_from_md > :first-child { margin-top: 0; } #gxuvhaszck .gt_from_md > :last-child { margin-bottom: 0; } #gxuvhaszck .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #gxuvhaszck .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #gxuvhaszck .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #gxuvhaszck .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #gxuvhaszck .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #gxuvhaszck .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #gxuvhaszck .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #gxuvhaszck .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #gxuvhaszck .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #gxuvhaszck .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #gxuvhaszck .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #gxuvhaszck .gt_sourcenote { font-size: 90%; padding: 4px; } #gxuvhaszck .gt_left { text-align: left; } #gxuvhaszck .gt_center { text-align: center; } #gxuvhaszck .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #gxuvhaszck .gt_font_normal { font-weight: normal; } #gxuvhaszck .gt_font_bold { font-weight: bold; } #gxuvhaszck .gt_font_italic { font-style: italic; } #gxuvhaszck .gt_super { font-size: 65%; } #gxuvhaszck .gt_footnote_marks { font-style: italic; font-size: 65%; } Végső adattábla modellezéshez age sex chronic_disease_binary date died india 78 male FALSE 2020-02-21 TRUE FALSE 61 female FALSE 2020-02-14 FALSE FALSE 28 male FALSE 2020-02-14 FALSE FALSE 56 female FALSE 2020-02-14 FALSE FALSE 79 female FALSE 2020-02-14 FALSE FALSE 26 male FALSE 2020-02-15 FALSE FALSE Modellbecslés dat %&gt;% rpart::rpart(formula = died ~ ., cp = .01) %&gt;% # TODO tune cp rattle::fancyRpartPlot(palettes = &#39;OrRd&#39;, sub = &#39;cp = .01&#39;, main = &#39;1. döntési fa&#39;) Open COVID-19 Data Working Group, Detailed Epidemiological Data from the COVID-19 Outbreak, http://virological.org/t/epidemiological-data-from-the-ncov-2019-outbreak-early-descriptions-from-publicly-available-data/337, letöltve: 2020.12.28.↩︎ Az intervallumok hossza nem egyezett meg.↩︎ "],
["Chapter-4.html", "Logit-modell Változók parciális hatása a halálozási valószínűségre Logit modell kalibrálása az összes tisztított és korábban bemutatott változóra", " Logit-modell p { text-align: justify; } Változók parciális hatása a halálozási valószínűségre Egyesével regresszálva a változókat az alábbi grafikonokat kapjuk logit_age &lt;- glm(died~age, data=dat, family = binomial(logit)) summary(logit_age) Call: glm(formula = died ~ age, family = binomial(logit), data = dat) Deviance Residuals: Min 1Q Median 3Q Max -2.0456 -0.6758 -0.3856 -0.1311 3.1082 Coefficients: Estimate Std. Error z value Pr(&gt;|z|) (Intercept) -4.822445 0.138130 -34.91 &lt;2e-16 *** age 0.070655 0.002361 29.93 &lt;2e-16 *** --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 (Dispersion parameter for binomial family taken to be 1) Null deviance: 6004.7 on 5376 degrees of freedom Residual deviance: 4757.2 on 5375 degrees of freedom AIC: 4761.2 Number of Fisher Scoring iterations: 5 Logit modell kalibrálása az összes tisztított és korábban bemutatott változóra Outlierek és VIF mutató alapján #Országok szintjén magas VIF mutató látható logit &lt;- glm(died~., data=dat, family=binomial(logit)) summary(logit) Call: glm(formula = died ~ ., family = binomial(logit), data = dat) Deviance Residuals: Min 1Q Median 3Q Max -3.3169 -0.5631 -0.2986 0.0000 3.3579 Coefficients: (4 not defined because of singularities) Estimate Std. Error z value Pr(&gt;|z|) (Intercept) -5.597e+02 4.593e+01 -12.185 &lt; 2e-16 *** age 7.284e-02 2.721e-03 26.774 &lt; 2e-16 *** sexmale 4.058e-01 8.495e-02 4.777 1.78e-06 *** countryAustralia 3.608e+00 3.265e+00 1.105 0.2691 countryBahamas 1.372e+01 3.956e+03 0.003 0.9972 countryBrazil -1.936e+01 1.836e+03 -0.011 0.9916 countryBurkina Faso 1.666e+01 3.956e+03 0.004 0.9966 countryCabo Verde 1.536e+01 3.956e+03 0.004 0.9969 countryCameroon 1.732e+01 3.956e+03 0.004 0.9965 countryCanada -6.502e+00 2.725e+00 -2.386 0.0170 * countryChina 4.793e+00 2.566e+00 1.868 0.0618 . countryCuba 1.421e+01 3.956e+03 0.004 0.9971 countryEswatini -1.500e+01 3.956e+03 -0.004 0.9970 countryEthiopia 1.782e+01 3.956e+03 0.005 0.9964 countryFrance 5.098e-01 2.017e+00 0.253 0.8004 countryGabon 1.757e+01 3.956e+03 0.004 0.9965 countryGambia -4.257e+00 2.112e+00 -2.015 0.0439 * countryGermany -1.785e+01 3.956e+03 -0.005 0.9964 countryGuyana 1.207e+01 2.797e+03 0.004 0.9966 countryIndia 2.990e+00 1.835e+00 1.630 0.1031 countryItaly 1.846e+00 1.822e+00 1.013 0.3111 countryJapan 6.014e+00 3.449e+00 1.743 0.0813 . countryMalaysia -1.207e+01 1.300e+03 -0.009 0.9926 countryNepal -1.151e+01 2.797e+03 -0.004 0.9967 countryNiger 1.615e+01 3.956e+03 0.004 0.9967 countryPhilippines 2.101e+00 2.712e+00 0.775 0.4383 countryRomania -1.505e+01 1.287e+03 -0.012 0.9907 countrySan Marino 1.560e+01 3.956e+03 0.004 0.9969 countrySingapore -1.237e+01 3.310e+02 -0.037 0.9702 countrySouth Korea -1.061e+01 7.347e+02 -0.014 0.9885 countrySudan 1.866e+01 3.956e+03 0.005 0.9962 countrySwitzerland -1.633e+01 2.673e+03 -0.006 0.9951 countryTanzania -1.574e+01 3.956e+03 -0.004 0.9968 countryTogo -1.656e+01 3.956e+03 -0.004 0.9967 countryUnited States -3.085e+00 2.805e+00 -1.100 0.2714 countryVietnam -1.432e+01 5.579e+02 -0.026 0.9795 countryZimbabwe 1.765e+00 2.132e+00 0.828 0.4079 chronic_disease_binaryTRUE 3.231e+00 3.292e-01 9.815 &lt; 2e-16 *** latitude -2.284e-03 1.658e-02 -0.138 0.8904 longitude -4.044e-02 2.264e-02 -1.786 0.0741 . continentAmericas NA NA NA NA continentAsia NA NA NA NA continentEurope NA NA NA NA continentOceania NA NA NA NA date 3.032e-02 2.503e-03 12.115 &lt; 2e-16 *** --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 (Dispersion parameter for binomial family taken to be 1) Null deviance: 6004.7 on 5376 degrees of freedom Residual deviance: 3754.8 on 5336 degrees of freedom AIC: 3836.8 Number of Fisher Scoring iterations: 16 vif(logit) age sexmale 1.085588 1.025914 countryAustralia countryBahamas Inf Inf countryBrazil countryBurkina Faso Inf 1.167971 countryCabo Verde countryCameroon 1.216675 1.170973 countryCanada countryChina Inf Inf countryCuba countryEswatini Inf 1.249802 countryEthiopia countryFrance 1.198986 Inf countryGabon countryGambia 1.183163 2.004172 countryGermany countryGuyana Inf Inf countryIndia countryItaly Inf Inf countryJapan countryMalaysia Inf Inf countryNepal countryNiger Inf 1.161126 countryPhilippines countryRomania Inf Inf countrySan Marino countrySingapore Inf Inf countrySouth Korea countrySudan Inf 1.181147 countrySwitzerland countryTanzania Inf 1.205269 countryTogo countryUnited States 1.176805 Inf countryVietnam countryZimbabwe Inf 1.448560 chronic_disease_binaryTRUE latitude 1.133290 7.748399 longitude continentAmericas 238.200123 Inf continentAsia continentEurope Inf Inf continentOceania date Inf 2.137974 #Outlierek leszűrése dat &lt;- dat[abs(rstudent(logit))&lt;3, ] #Országok kihagyásával mérséklődik a VIF mutató logit2 &lt;- glm(died~.-country -longitude -latitude, data=dat, family=binomial(logit)) summary(logit2) Call: glm(formula = died ~ . - country - longitude - latitude, family = binomial(logit), data = dat) Deviance Residuals: Min 1Q Median 3Q Max -2.3750 -0.6113 -0.3195 -0.0667 3.3074 Coefficients: Estimate Std. Error z value Pr(&gt;|z|) (Intercept) -6.836e+02 4.083e+01 -16.743 &lt; 2e-16 *** age 7.786e-02 2.677e-03 29.085 &lt; 2e-16 *** sexmale 4.658e-01 7.954e-02 5.856 4.74e-09 *** chronic_disease_binaryTRUE 2.981e+00 3.085e-01 9.661 &lt; 2e-16 *** continentAmericas 1.116e+00 8.223e-01 1.357 0.17487 continentAsia -1.931e+00 7.074e-01 -2.729 0.00635 ** continentEurope 4.161e-01 9.988e-01 0.417 0.67696 continentOceania -1.424e+00 1.197e+00 -1.189 0.23427 date 3.702e-02 2.224e-03 16.643 &lt; 2e-16 *** --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 (Dispersion parameter for binomial family taken to be 1) Null deviance: 5936.6 on 5347 degrees of freedom Residual deviance: 4158.6 on 5339 degrees of freedom (13 observations deleted due to missingness) AIC: 4176.6 Number of Fisher Scoring iterations: 5 vif(logit2) age sexmale 1.043362 1.007774 chronic_disease_binaryTRUE continentAmericas 1.063105 4.677268 continentAsia continentEurope 7.688847 2.356878 continentOceania date 2.717010 1.135966 #Amerikát összevonva Ázsiával a VIF mutatók lecsökkennek dat &lt;- na.omit(dat) dat[dat$continent==&quot;Americas&quot;, &quot;continent&quot;] &lt;- &quot;Asia&quot; logit3 &lt;- glm(died~.-country -longitude -latitude, data=dat, family=binomial(logit)) summary(logit3) Call: glm(formula = died ~ . - country - longitude - latitude, family = binomial(logit), data = dat) Deviance Residuals: Min 1Q Median 3Q Max -2.3229 -0.6220 -0.3234 -0.0779 3.2986 Coefficients: Estimate Std. Error z value Pr(&gt;|z|) (Intercept) -5.997e+02 3.859e+01 -15.540 &lt; 2e-16 *** age 7.906e-02 2.658e-03 29.740 &lt; 2e-16 *** sexmale 4.649e-01 7.863e-02 5.912 3.37e-09 *** chronic_disease_binaryTRUE 2.929e+00 3.093e-01 9.472 &lt; 2e-16 *** continentAsia -1.737e+00 7.107e-01 -2.445 0.0145 * continentEurope 3.201e-01 1.007e+00 0.318 0.7507 continentOceania -1.546e+00 1.194e+00 -1.295 0.1954 date 3.244e-02 2.102e-03 15.432 &lt; 2e-16 *** --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 (Dispersion parameter for binomial family taken to be 1) Null deviance: 5936.6 on 5347 degrees of freedom Residual deviance: 4227.6 on 5340 degrees of freedom AIC: 4243.6 Number of Fisher Scoring iterations: 5 vif(logit3) age sexmale 1.028043 1.007773 chronic_disease_binaryTRUE continentAsia 1.062988 4.058929 continentEurope continentOceania 2.356839 2.716772 date 1.097746 #Sajnos még nem lineáris a modellünk, a változókat át kell alakítani resettest(logit3) RESET test data: logit3 RESET = 123.11, df1 = 2, df2 = 5338, p-value &lt; 2.2e-16 crPlots(logit3) Nemlinearitás vizsgálata a RESET-teszttel #Először a dátumot vesszük ki a magyarázóváltozók közül, mivel az értelmezése nehézkes, #majd az életkor változóját alakítjuk át a linearitás eléréséhez logit4 &lt;- glm(died~.-country -date -latitude -longitude +I(1/(0.1+age)), data=dat, family=binomial(logit)) summary(logit4) Call: glm(formula = died ~ . - country - date - latitude - longitude + I(1/(0.1 + age)), family = binomial(logit), data = dat) Deviance Residuals: Min 1Q Median 3Q Max -2.1856 -0.6591 -0.3652 -0.1435 3.0292 Coefficients: Estimate Std. Error z value Pr(&gt;|z|) (Intercept) -4.621513 0.704158 -6.563 5.27e-11 *** age 0.074179 0.002508 29.580 &lt; 2e-16 *** sexmale 0.447841 0.076053 5.889 3.90e-09 *** chronic_disease_binaryTRUE 1.778913 0.284114 6.261 3.82e-10 *** continentAsia -0.733078 0.687754 -1.066 0.286468 continentEurope -0.417980 0.991142 -0.422 0.673232 continentOceania -2.311118 1.095266 -2.110 0.034850 * I(1/(0.1 + age)) 0.352330 0.091441 3.853 0.000117 *** --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 (Dispersion parameter for binomial family taken to be 1) Null deviance: 5936.6 on 5347 degrees of freedom Residual deviance: 4495.6 on 5340 degrees of freedom AIC: 4511.6 Number of Fisher Scoring iterations: 5 vif(logit4) age sexmale 1.056523 1.007713 chronic_disease_binaryTRUE continentAsia 1.025718 4.042502 continentEurope continentOceania 2.352099 2.704910 I(1/(0.1 + age)) 1.028043 resettest(logit4) RESET test data: logit4 RESET = 75.368, df1 = 2, df2 = 5338, p-value &lt; 2.2e-16 crPlots(logit4) logit5 &lt;- glm(died~.-country -age +I(1/(0.1+age)) -date -latitude -longitude, data=dat, family=binomial(logit)) summary(logit5) Call: glm(formula = died ~ . - country - age + I(1/(0.1 + age)) - date - latitude - longitude, family = binomial(logit), data = dat) Deviance Residuals: Min 1Q Median 3Q Max -1.9112 -0.7956 -0.6485 -0.5462 3.3660 Coefficients: Estimate Std. Error z value Pr(&gt;|z|) (Intercept) -0.37968 0.55595 -0.683 0.4946 sexmale 0.46798 0.06653 7.035 2e-12 *** chronic_disease_binaryTRUE 2.63226 0.26352 9.989 &lt;2e-16 *** continentAsia -1.06407 0.55564 -1.915 0.0555 . continentEurope -0.96595 0.76258 -1.267 0.2053 continentOceania -2.18141 0.92486 -2.359 0.0183 * I(1/(0.1 + age)) -0.42176 0.34692 -1.216 0.2241 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 (Dispersion parameter for binomial family taken to be 1) Null deviance: 5936.6 on 5347 degrees of freedom Residual deviance: 5722.7 on 5341 degrees of freedom AIC: 5736.7 Number of Fisher Scoring iterations: 6 vif(logit5) sexmale chronic_disease_binaryTRUE 1.003989 1.003505 continentAsia continentEurope 4.040352 2.349987 continentOceania I(1/(0.1 + age)) 2.704254 1.000201 resettest(logit5) RESET test data: logit5 RESET = 2.497, df1 = 2, df2 = 5339, p-value = 0.08243 #Elhagyható a magyarázóváltozók közül szinte az összes linearHypothesis(logit5, c(&quot;I(1/(0.1 + age))=0&quot;, &quot;continentEurope=0&quot;, &quot;continentAsia=0&quot;, &quot;continentOceania=0&quot;)) Linear hypothesis test Hypothesis: I(1/(0.1 + age)) = 0 continentEurope = 0 continentAsia = 0 continentOceania = 0 Model 1: restricted model Model 2: died ~ (age + sex + country + chronic_disease_binary + latitude + longitude + continent + date) - country - age + I(1/(0.1 + age)) - date - latitude - longitude Res.Df Df Chisq Pr(&gt;Chisq) 1 5345 2 5341 4 7.4952 0.1119 logit6 &lt;- glm(died~.-country -continent -age -date -latitude -longitude, data=dat, family=binomial(logit)) summary(logit6) Call: glm(formula = died ~ . - country - continent - age - date - latitude - longitude, family = binomial(logit), data = dat) Deviance Residuals: Min 1Q Median 3Q Max -1.9143 -0.7952 -0.6461 -0.6461 1.8272 Coefficients: Estimate Std. Error z value Pr(&gt;|z|) (Intercept) -1.46064 0.05146 -28.385 &lt; 2e-16 *** sexmale 0.47137 0.06644 7.094 1.3e-12 *** chronic_disease_binaryTRUE 2.64704 0.26334 10.052 &lt; 2e-16 *** --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 (Dispersion parameter for binomial family taken to be 1) Null deviance: 5936.6 on 5347 degrees of freedom Residual deviance: 5734.4 on 5345 degrees of freedom AIC: 5740.4 Number of Fisher Scoring iterations: 4 resettest(logit6) RESET test data: logit6 RESET = 0.9037, df1 = 2, df2 = 5343, p-value = 0.4051 #Az együtthatók jelentése exp(coef(logit6)) (Intercept) sexmale 0.2320868 1.6021878 chronic_disease_binaryTRUE 14.1121469 Előrejelzés a kiválasztott modellel deathval &lt;- predict(logit6, dat, type=&quot;response&quot;) dat$deathval &lt;- deathval dat$becsult &lt;- ifelse(deathval&gt;0.5, &quot;TRUE&quot;, &quot;FALSE&quot;) xtabs(~died+becsult, data=dat) becsult died FALSE TRUE FALSE 4028 18 TRUE 1220 82 #A modell 77%-ban helyes eredményt ad sum(dat$died==dat$becsult)/nrow(dat) [1] 0.7685116 Optimális cut-off érték kiválasztása ROCgorbe &lt;- roc(dat$died~dat$deathval) plot(ROCgorbe) 2*auc(ROCgorbe)-1 [1] 0.1684161 #Mivel csak 4 típusú kimenetel lehet a megmaradt változókból, #így a költségfüggvény is 5 értéket vesz fel ytengely &lt;- ROCgorbe$sensitivities xtengely &lt;- ROCgorbe$specificities kuszob &lt;- ROCgorbe$thresholds seged &lt;- data.frame(kuszob, xtengely, ytengely) table(dat$died) FALSE TRUE 4046 1302 seged$koltseg &lt;- 4046*(1-xtengely)+1302*(1-ytengely) ggplot(seged, aes(x=kuszob, y=koltseg))+geom_point()+geom_smooth()+xlim(0,1) A függvény alapján a 0.5 lesz az optimális küszöbérték "],
["Chapter-3.html", "A Guardian napilap COVID-19-el kapcsolatos címeinek elemzése", " A Guardian napilap COVID-19-el kapcsolatos címeinek elemzése p { text-align: justify; } Guardian headlineok #521-ig lehetett visszamenni a keresésben for (i in 1:528) { URL &lt;- paste(&quot;https://www.theguardian.com/world/coronavirus-outbreak+uk/uk?page=&quot;, i, sep = &quot;&quot;) page &lt;- read_html(URL) title &lt;- html_text(html_nodes(page, &quot;.js-headline-text&quot;)) #Van olyan hogy egy lapon két dátum is szerepel, heti bontás miatt ez nem probléma time &lt;- html_text(html_nodes(page, &quot;.fc-date-headline&quot;))[1] if (i==1){ data_raw &lt;- data.frame(time, title) } else{ data_raw &lt;- rbind(data_raw, data.frame(time, title)) } } Mivel nem volt olyan CSS kód ami egyértelműen jelölte volna ki a címeket, így duplikálva kerültek be a dataframebe, minden másodikat ki kellett törölni data_cleansed &lt;- data_raw %&gt;% filter(!duplicated(title)) %&gt;% {mutate(., id = seq(nrow(.)))} %&gt;% mutate( date = as.Date(time, format = &quot;%d %B %Y&quot;), month = format(date, &quot;%Y-%m&quot;) ) %&gt;% na.omit() Bag of words módszerhez a lescrape-elt címekből korpuszt készítettünk corpus_raw &lt;- Corpus(VectorSource(as.character(data_cleansed$title))) #Korpusz tisztítása corpus_filtered &lt;- corpus_raw %&gt;% tm_map(content_transformer(tolower)) %&gt;% tm_map(stripWhitespace) %&gt;% tm_map(removeNumbers) %&gt;% tm_map(removePunctuation, ucp=TRUE) %&gt;% tm_map(removeWords, c(stopwords(&quot;english&quot;), &quot;also&quot;, &quot;one&quot;)) Strukturált mátrix és a fogalmak eloszlása a teljes korpuszban termdocument &lt;- removeSparseTerms(TermDocumentMatrix(corpus_filtered), 0.999) documentterm &lt;- removeSparseTerms(DocumentTermMatrix(corpus_filtered), 0.999) words_frequency_all &lt;- data.frame(Words=row.names(as.matrix(termdocument)), Freq=rowSums(as.matrix(termdocument), na.rm = TRUE)) freqterms &lt;- findFreqTerms(documentterm, lowfreq = 100) ggwordcloud(words_frequency_all$Words, words_frequency_all$Freq, max.words = 100) Havonta elemzés data_cleansed_monthly &lt;- data_cleansed %&gt;% group_by(month) %&gt;% summarise(monthly_text = paste(title, collapse = &quot; &quot;)) #Táblázat létrehozása words_monthly &lt;- data.frame(matrix(ncol=nrow(data_cleansed_monthly), nrow=15)) colnames(words_monthly) &lt;- data_cleansed_monthly$month for (i in 1:nrow(data_cleansed_monthly)){ #Corpus létrehozása corpus_monthly_raw &lt;- Corpus(VectorSource(as.character(data_cleansed_monthly$monthly_text[i]))) #Korpusz tisztítása corpus_monthly_filtered &lt;- corpus_monthly_raw %&gt;% tm_map(content_transformer(tolower)) %&gt;% tm_map(removePunctuation, ucp=TRUE) %&gt;% tm_map(removeNumbers) %&gt;% tm_map(removeWords, c(stopwords(&quot;english&quot;), &quot;also&quot;, &quot;one&quot;)) #%&gt;% tm_map(stemDocument) #Term-Document mátrix létrehozása a 10 leggyakoribb szó miatt matrix_monthly &lt;- removeSparseTerms(TermDocumentMatrix(corpus_monthly_filtered), 0.999) words_frequency &lt;- data.frame(Words = matrix_monthly$dimnames$Terms, Freq = matrix_monthly$v) words_monthly[,data_cleansed_monthly$month[i]]&lt;- head(words_frequency[order(-words_frequency$Freq),]$Words,15) #Szófelhők készítése, a corpus nagyságától függően plot(ggwordcloud(words_frequency$Words, words_frequency$Freq, max.words = 100)+ ggtitle(data_cleansed_monthly$month[i])) #wordcloud(corpus_monthly_filtered, max.words=0.1*matrix_monthly$nrow) } #A globálisan leggyakoribb szavakat kiszíneztük havonta is color_freq_terms &lt;- data.frame(words = head(words_frequency_all[order(-words_frequency_all$Freq),]$Words,15), colors=sequential_hcl(15, palette = &quot;OrYel&quot;)) datatable(words_monthly) %&gt;% formatStyle(names(words_monthly), font=&quot;bold&quot;, background = styleEqual(as.vector(color_freq_terms$words), as.vector(color_freq_terms$colors))) Sentiment elemzés #AFINN lexikon betöltése AFINN &lt;- get_sentiments(&quot;afinn&quot;) data_cleansed &lt;- data_cleansed %&gt;% mutate( title = as.character(title) ) #Szavakra bontás, pontszámok összeaggregálása words &lt;- left_join( tidytext::unnest_tokens(data_cleansed, words, title), AFINN, by=c(&quot;words&quot;=&quot;word&quot;)) nr_sentiment_words &lt;- words %&gt;% group_by(date) %&gt;% summarise(non_na_count = sum(!is.na(value))) score_by_id &lt;- words %&gt;% group_by(id) %&gt;% summarize(score=sum(value, na.rm=TRUE)) #Eredeti adatok mellé rakás data_cleansed &lt;- left_join(data_cleansed, score_by_id, by=&quot;id&quot;) #Napi (és heti) aggregálás score_by_day &lt;- data_cleansed %&gt;% group_by(date) %&gt;% summarize(score_sum=sum(score, na.rm=TRUE), score_avg=mean(score, na.rm=TRUE)) Ábrázolás ggplot(nr_sentiment_words, aes(x=date)) + geom_line( aes(y=non_na_count), size=.5, color=&quot;#0fad04&quot;)+ xlab(&quot;Dátum&quot;) + ylab(&quot;AFINN-ban szereplő szavak száma&quot;) + ylim(0, 100)+ geom_hline(yintercept=0, color=&quot;black&quot;, size=.75) ggplot(score_by_day, aes(x=date)) + geom_line( aes(y=score_avg), color=&quot;#0fad04&quot;) + xlab(&quot;Dátum&quot;) + ylab(&quot;Átlagos napi érzelmi pontszám&quot;) + ylim(-5, 5)+ geom_hline(yintercept=0, color=&quot;black&quot;, size=.75) "]
]
